<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="28,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">P</span>, <span class="var type1" id="S3T1U4">T_or_H_ho</span>, <span class="var type1" id="S4T1U5">T_or_H_co</span> ] = HeatExNTU_3_low( <span class="var type1" id="S5T1U8">T_or_H_hi</span>, <span class="var type1" id="S6T1U9">m_dot_h</span>, <span class="var type1" id="S7T1U10">p_h</span>,  <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,2" id="srcline2">  2</a></span><span class="line">    <span class="var type1" id="S8T1U11">T_or_H_ci</span>, <span class="var type1" id="S9T1U12">m_dot_c</span>, <span class="var type1" id="S10T1U13">p_c</span>, <span class="var type2" id="S11T1V1U14">fluid_h</span>, <span class="var type2" id="S12T1V1U15">fluid_c</span>, <span class="var type1" id="S13T1U16">HeatExType</span>, <span class="var type1" id="S14T1U17">U</span>, <span class="var type1" id="S15T1U18">A</span>, <span class="var type2" id="S16T12V2U19">T_or_H</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="28,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%HeatExNTU Summary </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   This function calculates flow and outlet temperatures of a heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   using the Number of Transfer Units (NTU) method as described in</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   Fundementals of Heat and Mass Transfer by F. P. Incropera, D. P.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   DeWitt, T. L. Bergman &amp; A. S. Lavine. The method can be used when only</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   the inlet tempertures are known as opposed to inlet and outlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   temperatures.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   This is done by calculating effectiveness which is defined as the ratio</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   of actual heat transferred to the maximum possible heat transferred for </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   an infinite length counter-flow heat exchanger with the given inlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%   temperatures. The effectivenes is calculated differently depending on </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%   the geometry of exchanger but is always a function of the ratio of heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%   capacity rates as well as the number of transfer units (NTU). The NTU</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%   depends on the overall heat transfer coefficient, the heat transfer</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%   area, and the smaller of the two heat capacity rates. </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%   </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%   In the event of a phase change the rate of change of energy required to</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%   get the fluid just beyond the point of vaporizaion or condensation is</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%   calculated using the CoolProp function. Then the function is called</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%   again at the new temperature and the final temperatures and heat rates</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%   are calucluated using a reduced heat exhange area. I currently assume</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%   the effected heat transfer area is a half of the original input. This </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%   function cannot accurately handle both fluids changing phase because it</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%   does not check which fluid would change first.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% Note: The effectiveness is separte from efficiency. The calculations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%   assumes an efficiency of 1 where all heat is transferred from the hot</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%   fluid to the cool fluid or remains within the the fluid. This also</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%   assumes no fluid is undergoing a change in state, which may not be</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%   sufficient for my final model.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% This function makes use of CoolProp, a shared DLL. </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">% More information about the Matlab wrapper can be found at</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/coolprop/wrappers/MATLAB/index.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% A list of parameters can be found at </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/coolprop/HighLevelAPI.html#parameter-table</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">% A list of fluids can be found at </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/fluid_properties/PurePseudoPure.html#list-of-fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%   T_or_H_hi   Hot fluid inlet temperature in Kelvin or enthalpy in J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%   m_dot_h     Hot fluid mass flow rate in kg/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%   p_h         Hot fluid pressure in pa</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%   fluid_h     Name of Hot fluid (string)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%   T_or_H_ci   Cool fluid inlet temperature in Kelvin or enthalpy in J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%   m_dot_c     Cool fluid mass flow rate in kg/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%   p_c         Cool fluid pressure in pa</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%   fluid_c     Name of Cool fluid (string)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%   HeatExType  String describing the heat exchanger geometry. Currently</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%               this variable only accepts 'counter' and 'parallel', but</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%               can be expanded to other exchanger/flow types</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%               'counter' for counter flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%               'parallel' for parallel</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%   U           Overall heat transfer coefficient in W/(K m2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%   A           Heat transfer area in m2</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%   T_or_H      String stating whether arguements 1&amp;5 are temperature (T) </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%               or enthaply (H). Also applies to output</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">% Output:</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%   P           Rate of heat exchenged (power) in W</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%   T_or_H_ho   Hot fluid outlet temperature (K) or enthalpy J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%   T_or_H_co   Cool fluid outlet temperature (K) or enthalpy J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,66" id="srcline66"> 66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">% initailize certain parameters used to call coolprop library</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo " id="T1:U16"><span class="var type1" id="S17T1U22">buffer_size</span> = <span class="mxinfo " id="T1:U18">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S18T1U26">ierr</span> = <span class="mxinfo " id="T1:U21">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo " id="T2:U22"><span class="var type1" id="S19T2U30">b</span> = (<span class="mxinfo " id="T2:U24">1:1:<span class="var type1" id="S17T1U36">buffer_size</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T3:U26"><span class="var type1" id="S20T3U39">herr</span>= <span class="mxinfo " id="T3:U28">char(<span class="var type1" id="S19T2U42">b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T4:U30"><span class="var type1" id="S22T4U45">backend</span> = <span class="mxinfo " id="T4:U32"><span class="string">'HEOS'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,73" id="srcline73"> 73</a></span><span class="line">coder.extrinsic(<span class="string">'calllib'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="28,74" id="srcline74"> 74</a></span><span class="line">coder.extrinsic(<span class="string">'libpointer'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="28,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% All the input signals should be the same size, so it shouldn't matter</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% which one is used to obtain signal length</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S24T1U61">var_length</span> = <span class="mxinfo " id="T1:U35">length(<span class="var type1" id="S5T1U64">T_or_H_hi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">% initialize handles for hot and cool fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,81" id="srcline81"> 81</a></span><span class="line">[<span class="var type1" id="S26T5U68">handle_h</span>, <span class="mxinfo " id="T5:U38">~</span>] = <span class="extrinsicFcn" id="F145N3:B71">calllib</span>(<span class="mxinfo " id="T6:U39"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T7:U40"><span class="string">'AbstractState_factory'</span></span>,<span class="var type1" id="S22T4U74">backend</span>,<span class="var type1" id="S11T1U75">fluid_h</span>,<span class="var type1" id="S18T1U76">ierr</span>,<span class="var type1" id="S20T3U77">herr</span>,<span class="var type1" id="S17T1U78">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,82" id="srcline82"> 82</a></span><span class="line">[<span class="var type1" id="S28T5U82">handle_c</span>, <span class="mxinfo " id="T5:U47">~</span>] = <span class="extrinsicFcn" id="F146N3:B85">calllib</span>(<span class="mxinfo " id="T6:U48"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T7:U49"><span class="string">'AbstractState_factory'</span></span>,<span class="var type1" id="S22T4U88">backend</span>,<span class="var type1" id="S12T1U89">fluid_c</span>,<span class="var type1" id="S18T1U90">ierr</span>,<span class="var type1" id="S20T3U91">herr</span>,<span class="var type1" id="S17T1U92">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">% determine input parameter pair indecies for coolprop calls</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,85" id="srcline85"> 85</a></span><span class="line">[<span class="var type1" id="S29T5U96">pq_ind</span>,<span class="mxinfo " id="T5:U56">~</span>] = <span class="extrinsicFcn" id="F147N3:B99">calllib</span>(<span class="mxinfo " id="T6:U57"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U58"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T9:U59"><span class="string">'PQ_INPUTS'</span></span>); <span class="comment">%pressure and Mass vapor quality</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,86" id="srcline86"> 86</a></span><span class="line">[<span class="var type1" id="S30T5U106">pt_ind</span>,<span class="mxinfo " id="T5:U61">~</span>] = <span class="extrinsicFcn" id="F148N3:B109">calllib</span>(<span class="mxinfo " id="T6:U62"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U63"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T9:U64"><span class="string">'PT_INPUTS'</span></span>); <span class="comment">%pressure and temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,87" id="srcline87"> 87</a></span><span class="line">[<span class="var type1" id="S31T5U116">hp_ind</span>,<span class="mxinfo " id="T5:U66">~</span>] = <span class="extrinsicFcn" id="F149N3:B119">calllib</span>(<span class="mxinfo " id="T6:U67"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U68"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T10:U69"><span class="string">'HmassP_INPUTS'</span></span>); <span class="comment">%Mass specific enthalpy and pressure</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">% determine output parameter indecies for coolprop calls</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,90" id="srcline90"> 90</a></span><span class="line">[<span class="var type1" id="S32T5U126">t_ind</span>, <span class="mxinfo " id="T5:U71">~</span>] = <span class="extrinsicFcn" id="F150N3:B129">calllib</span>(<span class="mxinfo " id="T6:U72"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U73"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T12:U74"><span class="string">'T'</span></span>); <span class="comment">%temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,91" id="srcline91"> 91</a></span><span class="line">[<span class="var type1" id="S33T5U136">h_ind</span>, <span class="mxinfo " id="T5:U76">~</span>] = <span class="extrinsicFcn" id="F151N3:B139">calllib</span>(<span class="mxinfo " id="T6:U77"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U78"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T13:U79"><span class="string">'Hmass'</span></span>); <span class="comment">%Mass specific enthalpy</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,92" id="srcline92"> 92</a></span><span class="line">[<span class="var type1" id="S34T5U146">c_ind</span>, <span class="mxinfo " id="T5:U81">~</span>] = <span class="extrinsicFcn" id="F152N3:B149">calllib</span>(<span class="mxinfo " id="T6:U82"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U83"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T14:U84"><span class="string">'Cpmass'</span></span>); <span class="comment">%Mass specific constant pressure specific heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,93" id="srcline93"> 93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">% find pointer location of pressure and temperature input values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T5:U85"><span class="var type1" id="S35T5U155">p_h_Ptr</span> = <span class="mxinfo " id="T5:U87"><span class="extrinsicFcn" id="F153N8:B157">libpointer</span>(<span class="mxinfo " id="T9:U88"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S7T1U159">p_h</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T5:U90"><span class="var type1" id="S37T5U162">p_c_Ptr</span> = <span class="mxinfo " id="T5:U92"><span class="extrinsicFcn" id="F154N8:B164">libpointer</span>(<span class="mxinfo " id="T9:U93"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S10T1U166">p_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">% Thi_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">% Tci_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">% Hhi_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,100" id="srcline100">100</a></span><span class="line"><span class="comment">% Hci_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,102" id="srcline102">102</a></span><span class="line"><span class="comment">% Ensure temperature/enthalpy input variables are delt with appropriately</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,103" id="srcline103">103</a></span><span class="line"><span class="keyword">if</span> upper(<span class="var type1" id="S16T12U172">T_or_H</span>) == <span class="string">'T'</span> <span class="comment">%|| 'TEMPERATURE'</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,104" id="srcline104">104</a></span><span class="line"><span class="comment">% Assume given temperature values are not at vaporization/condensation</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,106" id="srcline106">106</a></span><span class="line"><span class="comment">% Initialize T and H values </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,107" id="srcline107">107</a></span><span class="line">    <span class="var type0" id="S39T0U176">Thi</span> = <span class="var type0" id="S5T0U177">T_or_H_hi</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,108" id="srcline108">108</a></span><span class="line">    <span class="var type0" id="S40T0U180">Tci</span> = <span class="var type0" id="S8T0U181">T_or_H_ci</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,109" id="srcline109">109</a></span><span class="line">    <span class="var type0" id="S41T0U184">Thi_Ptr</span> = libpointer(<span class="string">'doublePtr'</span>,<span class="var type0" id="S39T0U188">Thi</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,110" id="srcline110">110</a></span><span class="line">    <span class="var type0" id="S42T0U191">Tci_Ptr</span> = libpointer(<span class="string">'doublePtr'</span>,<span class="var type0" id="S40T0U195">Tci</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,111" id="srcline111">111</a></span><span class="line">    <span class="var type0" id="S43T0U198">Hhi</span> = zeros(<span class="var type0" id="S24T0U201">var_length</span>,1); <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,112" id="srcline112">112</a></span><span class="line">    <span class="var type0" id="S45T0U205">Hci</span> = zeros(<span class="var type0" id="S24T0U208">var_length</span>,1); <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,113" id="srcline113">113</a></span><span class="line">    <span class="var type0" id="S46T0U212">Hhi_Ptr</span> = libpointer(<span class="string">'doublePtr'</span>,<span class="var type0" id="S43T0U216">Hhi</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,114" id="srcline114">114</a></span><span class="line">    <span class="var type0" id="S47T0U219">Hci_Ptr</span> = libpointer(<span class="string">'doublePtr'</span>,<span class="var type0" id="S45T0U223">Hci</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,115" id="srcline115">115</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,116" id="srcline116">116</a></span><span class="line"><span class="comment">% Update values located at Hhi and Hci pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,117" id="srcline117">117</a></span><span class="line">    calllib(<span class="string">'coolprop'</span>,<span class="string">'AbstractState_update_and_1_out'</span>, <span class="var type0" id="S26T0U229">handle_h</span>, <span class="var type0" id="S30T0U230">pt_ind</span>, <span class="var type0" id="S35T0U231">p_h_Ptr</span>, <span class="var type0" id="S41T0U232">Thi_Ptr</span>, <span class="var type0" id="S24T0U233">var_length</span>, <span class="var type0" id="S33T0U234">h_ind</span>, <span class="var type0" id="S46T0U235">Hhi_Ptr</span>, <span class="var type0" id="S18T0U236">ierr</span>,<span class="var type0" id="S20T0U237">herr</span>,<span class="var type0" id="S17T0U238">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,118" id="srcline118">118</a></span><span class="line">    calllib(<span class="string">'coolprop'</span>,<span class="string">'AbstractState_update_and_1_out'</span>, <span class="var type0" id="S28T0U244">handle_c</span>, <span class="var type0" id="S30T0U245">pt_ind</span>, <span class="var type0" id="S37T0U246">p_c_Ptr</span>, <span class="var type0" id="S42T0U247">Tci_Ptr</span>, <span class="var type0" id="S24T0U248">var_length</span>, <span class="var type0" id="S33T0U249">h_ind</span>, <span class="var type0" id="S47T0U250">Hci_Ptr</span>, <span class="var type0" id="S18T0U251">ierr</span>,<span class="var type0" id="S20T0U252">herr</span>,<span class="var type0" id="S17T0U253">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,119" id="srcline119">119</a></span><span class="line"><span class="comment">% Set Hhi &amp; Hci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,120" id="srcline120">120</a></span><span class="line">    <span class="var type0" id="S43T0U256">Hhi</span> = get(<span class="var type0" id="S46T0U259">Hhi_Ptr</span>,<span class="string">'Value'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,121" id="srcline121">121</a></span><span class="line">    <span class="var type0" id="S45T0U263">Hci</span> = get(<span class="var type0" id="S47T0U266">Hci_Ptr</span>,<span class="string">'Value'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,122" id="srcline122">122</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,123" id="srcline123">123</a></span><span class="line"><span class="keyword">elseif</span> upper(<span class="var type1" id="S16T12U272">T_or_H</span>) == <span class="string">'H'</span> <span class="comment">%|| 'ENTHALPY'</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,124" id="srcline124">124</a></span><span class="line"><span class="comment">% Enthalpy values can be in vaporization/condensation region    </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,125" id="srcline125">125</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,126" id="srcline126">126</a></span><span class="line"><span class="comment">% Initialize H and T values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,127" id="srcline127">127</a></span><span class="line">    <span class="mxinfo " id="T1:U97"><span class="var type1" id="S43T1U276">Hhi</span> = <span class="var type1" id="S5T1U277">T_or_H_hi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,128" id="srcline128">128</a></span><span class="line">    <span class="mxinfo " id="T1:U100"><span class="var type1" id="S45T1U280">Hci</span> = <span class="var type1" id="S8T1U281">T_or_H_ci</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo " id="T5:U103"><span class="var type1" id="S46T5U284">Hhi_Ptr</span> = <span class="mxinfo " id="T5:U105"><span class="extrinsicFcn" id="F168N8:B286">libpointer</span>(<span class="mxinfo " id="T9:U106"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S43T1U288">Hhi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo " id="T5:U108"><span class="var type1" id="S47T5U291">Hci_Ptr</span> = <span class="mxinfo " id="T5:U110"><span class="extrinsicFcn" id="F169N8:B293">libpointer</span>(<span class="mxinfo " id="T9:U111"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S45T1U295">Hci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo " id="T1:U113"><span class="var type1" id="S39T1U298">Thi</span> = <span class="mxinfo " id="T1:U115">zeros(<span class="var type1" id="S24T1U301">var_length</span>,1)</span></span>; <span class="comment">%initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T1:U117"><span class="var type1" id="S40T1U305">Tci</span> = <span class="mxinfo " id="T1:U119">zeros(<span class="var type1" id="S24T1U308">var_length</span>,1)</span></span>; <span class="comment">%initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T5:U121"><span class="var type1" id="S41T5U312">Thi_Ptr</span> = <span class="mxinfo " id="T5:U123"><span class="extrinsicFcn" id="F170N8:B314">libpointer</span>(<span class="mxinfo " id="T9:U124"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S39T1U316">Thi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T5:U126"><span class="var type1" id="S42T5U319">Tci_Ptr</span> = <span class="mxinfo " id="T5:U128"><span class="extrinsicFcn" id="F171N8:B321">libpointer</span>(<span class="mxinfo " id="T9:U129"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S40T1U323">Tci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,135" id="srcline135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,136" id="srcline136">136</a></span><span class="line"><span class="comment">% Update values located at Thi and Tci pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo " id="T5:U131"><span class="extrinsicFcn" id="F172N3:B326">calllib</span>(<span class="mxinfo " id="T6:U132"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U133"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U329">handle_h</span>, <span class="var type1" id="S31T5U330">hp_ind</span>, <span class="var type1" id="S46T5U331">Hhi_Ptr</span>, <span class="var type1" id="S35T5U332">p_h_Ptr</span>, <span class="var type1" id="S24T1U333">var_length</span>, <span class="var type1" id="S32T5U334">t_ind</span>, <span class="var type1" id="S41T5U335">Thi_Ptr</span>, <span class="var type1" id="S18T1U336">ierr</span>,<span class="var type1" id="S20T3U337">herr</span>,<span class="var type1" id="S17T1U338">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo " id="T5:U144"><span class="extrinsicFcn" id="F173N3:B341">calllib</span>(<span class="mxinfo " id="T6:U145"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U146"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U344">handle_c</span>, <span class="var type1" id="S31T5U345">hp_ind</span>, <span class="var type1" id="S47T5U346">Hci_Ptr</span>, <span class="var type1" id="S37T5U347">p_c_Ptr</span>, <span class="var type1" id="S24T1U348">var_length</span>, <span class="var type1" id="S32T5U349">t_ind</span>, <span class="var type1" id="S42T5U350">Tci_Ptr</span>, <span class="var type1" id="S18T1U351">ierr</span>,<span class="var type1" id="S20T3U352">herr</span>,<span class="var type1" id="S17T1U353">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,139" id="srcline139">139</a></span><span class="line"><span class="comment">% Set Thi &amp; Tci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T1:U157"><span class="var type1" id="S39T1U356">Thi</span> = <span class="mxinfo " id="T5:U159"><span class="extrinsicFcn" id="F174N7:B358">get</span>(<span class="var type1" id="S41T5U359">Thi_Ptr</span>,<span class="mxinfo " id="T13:U161"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo " id="T1:U162"><span class="var type1" id="S40T1U363">Tci</span> = <span class="mxinfo " id="T5:U164"><span class="extrinsicFcn" id="F175N7:B365">get</span>(<span class="var type1" id="S42T5U366">Tci_Ptr</span>,<span class="mxinfo " id="T13:U166"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,142" id="srcline142">142</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,143" id="srcline143">143</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,144" id="srcline144">144</a></span><span class="line">    error(<span class="string">'Please specify whether input uses variables of Temperature or Enthalpy.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="28,145" id="srcline145">145</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,146" id="srcline146">146</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,147" id="srcline147">147</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,148" id="srcline148">148</a></span><span class="line"><span class="comment">% Determine vaporization temperature for fluids at respective pressures.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,149" id="srcline149">149</a></span><span class="line"><span class="comment">% Initialize pointer locations for relevant variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,150" id="srcline150">150</a></span><span class="line"><span class="mxinfo " id="T5:U167"><span class="var type1" id="S50T5U375">Q_Ptr</span> = <span class="mxinfo " id="T5:U169"><span class="extrinsicFcn" id="F176N8:B377">libpointer</span>(<span class="mxinfo " id="T9:U170"><span class="string">'doublePtr'</span></span>, <span class="mxinfo " id="T1:U171">zeros(<span class="var type1" id="S24T1U381">var_length</span>,1)</span>)</span></span>; <span class="comment">% Q is specifically set to 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,151" id="srcline151">151</a></span><span class="line"><span class="mxinfo " id="T1:U173"><span class="var type1" id="S51T1U385">Tvh</span> = <span class="mxinfo " id="T1:U175">zeros(<span class="var type1" id="S24T1U388">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo " id="T1:U177"><span class="var type1" id="S52T1U392">Tvc</span> = <span class="mxinfo " id="T1:U179">zeros(<span class="var type1" id="S24T1U395">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo " id="T5:U181"><span class="var type1" id="S53T5U399">Tvh_Ptr</span> = <span class="mxinfo " id="T5:U183"><span class="extrinsicFcn" id="F177N8:B401">libpointer</span>(<span class="mxinfo " id="T9:U184"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S51T1U403">Tvh</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo " id="T5:U186"><span class="var type1" id="S54T5U406">Tvc_Ptr</span> = <span class="mxinfo " id="T5:U188"><span class="extrinsicFcn" id="F178N8:B408">libpointer</span>(<span class="mxinfo " id="T9:U189"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S52T1U410">Tvc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,155" id="srcline155">155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,156" id="srcline156">156</a></span><span class="line"><span class="comment">% Update values located at the Tvc &amp; Tvh pointer locations for vaporization</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,157" id="srcline157">157</a></span><span class="line"><span class="comment">% conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,158" id="srcline158">158</a></span><span class="line"><span class="mxinfo " id="T5:U191"><span class="extrinsicFcn" id="F179N3:B413">calllib</span>(<span class="mxinfo " id="T6:U192"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U193"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U416">handle_h</span>, <span class="var type1" id="S29T5U417">pq_ind</span>, <span class="var type1" id="S35T5U418">p_h_Ptr</span>, <span class="var type1" id="S50T5U419">Q_Ptr</span>, <span class="var type1" id="S24T1U420">var_length</span>, <span class="var type1" id="S32T5U421">t_ind</span>, <span class="var type1" id="S53T5U422">Tvh_Ptr</span>, <span class="var type1" id="S18T1U423">ierr</span>,<span class="var type1" id="S20T3U424">herr</span>,<span class="var type1" id="S17T1U425">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo " id="T5:U204"><span class="extrinsicFcn" id="F180N3:B428">calllib</span>(<span class="mxinfo " id="T6:U205"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U206"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U431">handle_c</span>, <span class="var type1" id="S29T5U432">pq_ind</span>, <span class="var type1" id="S37T5U433">p_c_Ptr</span>, <span class="var type1" id="S50T5U434">Q_Ptr</span>, <span class="var type1" id="S24T1U435">var_length</span>, <span class="var type1" id="S32T5U436">t_ind</span>, <span class="var type1" id="S54T5U437">Tvc_Ptr</span>, <span class="var type1" id="S18T1U438">ierr</span>,<span class="var type1" id="S20T3U439">herr</span>,<span class="var type1" id="S17T1U440">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,160" id="srcline160">160</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,161" id="srcline161">161</a></span><span class="line"><span class="comment">% Set Tvh &amp; Tvc to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo " id="T1:U217"><span class="var type1" id="S51T1U443">Tvh</span> = <span class="mxinfo " id="T5:U219"><span class="extrinsicFcn" id="F181N7:B445">get</span>(<span class="var type1" id="S53T5U446">Tvh_Ptr</span>,<span class="mxinfo " id="T13:U221"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,163" id="srcline163">163</a></span><span class="line"><span class="mxinfo " id="T1:U222"><span class="var type1" id="S52T1U450">Tvc</span> = <span class="mxinfo " id="T5:U224"><span class="extrinsicFcn" id="F182N7:B452">get</span>(<span class="var type1" id="S54T5U453">Tvc_Ptr</span>,<span class="mxinfo " id="T13:U226"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,164" id="srcline164">164</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,165" id="srcline165">165</a></span><span class="line"><span class="comment">% Determine vaporization enthalpies for fluids at respective pressures</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,166" id="srcline166">166</a></span><span class="line"><span class="comment">% Min enthalpies of vaporization region for hot and cool fluids (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,167" id="srcline167">167</a></span><span class="line"><span class="mxinfo " id="T1:U227"><span class="var type1" id="S55T1U457">Hvh_min</span> = <span class="mxinfo " id="T1:U229">zeros(<span class="var type1" id="S24T1U460">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo " id="T1:U231"><span class="var type1" id="S56T1U464">Hvc_min</span> = <span class="mxinfo " id="T1:U233">zeros(<span class="var type1" id="S24T1U467">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo " id="T5:U235"><span class="var type1" id="S57T5U471">Hvh_min_Ptr</span> = <span class="mxinfo " id="T5:U237"><span class="extrinsicFcn" id="F183N8:B473">libpointer</span>(<span class="mxinfo " id="T9:U238"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S55T1U475">Hvh_min</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo " id="T5:U240"><span class="var type1" id="S58T5U478">Hvc_min_Ptr</span> = <span class="mxinfo " id="T5:U242"><span class="extrinsicFcn" id="F184N8:B480">libpointer</span>(<span class="mxinfo " id="T9:U243"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S56T1U482">Hvc_min</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,171" id="srcline171">171</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,172" id="srcline172">172</a></span><span class="line"><span class="comment">% Update values located at Hvh_max and Hvc_max pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo " id="T5:U245"><span class="extrinsicFcn" id="F185N3:B485">calllib</span>(<span class="mxinfo " id="T6:U246"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U247"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U488">handle_h</span>, <span class="var type1" id="S29T5U489">pq_ind</span>, <span class="var type1" id="S35T5U490">p_h_Ptr</span>, <span class="var type1" id="S50T5U491">Q_Ptr</span>, <span class="var type1" id="S24T1U492">var_length</span>, <span class="var type1" id="S33T5U493">h_ind</span>, <span class="var type1" id="S57T5U494">Hvh_min_Ptr</span>, <span class="var type1" id="S18T1U495">ierr</span>,<span class="var type1" id="S20T3U496">herr</span>,<span class="var type1" id="S17T1U497">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo " id="T5:U258"><span class="extrinsicFcn" id="F186N3:B500">calllib</span>(<span class="mxinfo " id="T6:U259"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U260"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U503">handle_c</span>, <span class="var type1" id="S29T5U504">pq_ind</span>, <span class="var type1" id="S37T5U505">p_c_Ptr</span>, <span class="var type1" id="S50T5U506">Q_Ptr</span>, <span class="var type1" id="S24T1U507">var_length</span>, <span class="var type1" id="S33T5U508">h_ind</span>, <span class="var type1" id="S58T5U509">Hvc_min_Ptr</span>, <span class="var type1" id="S18T1U510">ierr</span>,<span class="var type1" id="S20T3U511">herr</span>,<span class="var type1" id="S17T1U512">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,175" id="srcline175">175</a></span><span class="line"><span class="comment">% Set Hvh_max &amp; Hvc_max to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo " id="T1:U271"><span class="var type1" id="S55T1U515">Hvh_min</span> = <span class="mxinfo " id="T5:U273"><span class="extrinsicFcn" id="F187N7:B517">get</span>(<span class="var type1" id="S57T5U518">Hvh_min_Ptr</span>,<span class="mxinfo " id="T13:U275"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,177" id="srcline177">177</a></span><span class="line"><span class="mxinfo " id="T1:U276"><span class="var type1" id="S56T1U522">Hvc_min</span> = <span class="mxinfo " id="T5:U278"><span class="extrinsicFcn" id="F188N7:B524">get</span>(<span class="var type1" id="S58T5U525">Hvc_min_Ptr</span>,<span class="mxinfo " id="T13:U280"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,178" id="srcline178">178</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,179" id="srcline179">179</a></span><span class="line"><span class="comment">% Max enthalpies of vaporization region for hot and cool fluid (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,180" id="srcline180">180</a></span><span class="line"><span class="mxinfo " id="T5:U281"><span class="var type1" id="S50T5U529">Q_Ptr</span> = <span class="mxinfo " id="T5:U283"><span class="extrinsicFcn" id="F189N8:B531">libpointer</span>(<span class="mxinfo " id="T9:U284"><span class="string">'doublePtr'</span></span>, <span class="mxinfo " id="T1:U285">ones(<span class="var type1" id="S24T1U535">var_length</span>,1)</span>)</span></span>; <span class="comment">% Q is specifically set to 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,181" id="srcline181">181</a></span><span class="line"><span class="mxinfo " id="T1:U287"><span class="var type1" id="S60T1U539">Hvh_max</span> = <span class="mxinfo " id="T1:U289">zeros(<span class="var type1" id="S24T1U542">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,182" id="srcline182">182</a></span><span class="line"><span class="mxinfo " id="T1:U291"><span class="var type1" id="S61T1U546">Hvc_max</span> = <span class="mxinfo " id="T1:U293">zeros(<span class="var type1" id="S24T1U549">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo " id="T5:U295"><span class="var type1" id="S62T5U553">Hvh_max_Ptr</span> = <span class="mxinfo " id="T5:U297"><span class="extrinsicFcn" id="F190N8:B555">libpointer</span>(<span class="mxinfo " id="T9:U298"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S60T1U557">Hvh_max</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo " id="T5:U300"><span class="var type1" id="S63T5U560">Hvc_max_Ptr</span> = <span class="mxinfo " id="T5:U302"><span class="extrinsicFcn" id="F191N8:B562">libpointer</span>(<span class="mxinfo " id="T9:U303"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S61T1U564">Hvc_max</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,185" id="srcline185">185</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,186" id="srcline186">186</a></span><span class="line"><span class="comment">% Update values located at Hvh_max and Hvc_max pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo " id="T5:U305"><span class="extrinsicFcn" id="F192N3:B567">calllib</span>(<span class="mxinfo " id="T6:U306"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U307"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U570">handle_h</span>, <span class="var type1" id="S29T5U571">pq_ind</span>, <span class="var type1" id="S35T5U572">p_h_Ptr</span>, <span class="var type1" id="S50T5U573">Q_Ptr</span>, <span class="var type1" id="S24T1U574">var_length</span>, <span class="var type1" id="S33T5U575">h_ind</span>, <span class="var type1" id="S62T5U576">Hvh_max_Ptr</span>, <span class="var type1" id="S18T1U577">ierr</span>,<span class="var type1" id="S20T3U578">herr</span>,<span class="var type1" id="S17T1U579">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo " id="T5:U318"><span class="extrinsicFcn" id="F193N3:B582">calllib</span>(<span class="mxinfo " id="T6:U319"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U320"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U585">handle_c</span>, <span class="var type1" id="S29T5U586">pq_ind</span>, <span class="var type1" id="S37T5U587">p_c_Ptr</span>, <span class="var type1" id="S50T5U588">Q_Ptr</span>, <span class="var type1" id="S24T1U589">var_length</span>, <span class="var type1" id="S33T5U590">h_ind</span>, <span class="var type1" id="S63T5U591">Hvc_max_Ptr</span>, <span class="var type1" id="S18T1U592">ierr</span>,<span class="var type1" id="S20T3U593">herr</span>,<span class="var type1" id="S17T1U594">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,189" id="srcline189">189</a></span><span class="line"><span class="comment">% Set Hvh_max &amp; Hvc_max to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo " id="T1:U331"><span class="var type1" id="S60T1U597">Hvh_max</span> = <span class="mxinfo " id="T5:U333"><span class="extrinsicFcn" id="F194N7:B599">get</span>(<span class="var type1" id="S62T5U600">Hvh_max_Ptr</span>,<span class="mxinfo " id="T13:U335"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo " id="T1:U336"><span class="var type1" id="S61T1U604">Hvc_max</span> = <span class="mxinfo " id="T5:U338"><span class="extrinsicFcn" id="F195N7:B606">get</span>(<span class="var type1" id="S63T5U607">Hvc_max_Ptr</span>,<span class="mxinfo " id="T13:U340"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,192" id="srcline192">192</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,193" id="srcline193">193</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,194" id="srcline194">194</a></span><span class="line"><span class="comment">% Determine the specific heats of the incoming fluids using coolprop</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,195" id="srcline195">195</a></span><span class="line"><span class="comment">% Initialize pointer locations for relevant variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,196" id="srcline196">196</a></span><span class="line"><span class="mxinfo " id="T1:U341"><span class="var type1" id="S64T1U611">Ch</span> = <span class="mxinfo " id="T1:U343">zeros(<span class="var type1" id="S24T1U614">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,197" id="srcline197">197</a></span><span class="line"><span class="mxinfo " id="T1:U345"><span class="var type1" id="S65T1U618">Cc</span> = <span class="mxinfo " id="T1:U347">zeros(<span class="var type1" id="S24T1U621">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,198" id="srcline198">198</a></span><span class="line"><span class="mxinfo " id="T5:U349"><span class="var type1" id="S66T5U625">Ch_Ptr</span> = <span class="mxinfo " id="T5:U351"><span class="extrinsicFcn" id="F196N8:B627">libpointer</span>(<span class="mxinfo " id="T9:U352"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S64T1U629">Ch</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="28,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo " id="T5:U354"><span class="var type1" id="S67T5U632">Cc_Ptr</span> = <span class="mxinfo " id="T5:U356"><span class="extrinsicFcn" id="F197N8:B634">libpointer</span>(<span class="mxinfo " id="T9:U357"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S65T1U636">Cc</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="28,200" id="srcline200">200</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,201" id="srcline201">201</a></span><span class="line"><span class="comment">% Update values located at the Ch &amp; Cc pointer locations for input</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,202" id="srcline202">202</a></span><span class="line"><span class="comment">% conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,203" id="srcline203">203</a></span><span class="line"><span class="mxinfo " id="T5:U359"><span class="extrinsicFcn" id="F198N3:B639">calllib</span>(<span class="mxinfo " id="T6:U360"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U361"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U642">handle_h</span>, <span class="var type1" id="S30T5U643">pt_ind</span>, <span class="var type1" id="S35T5U644">p_h_Ptr</span>, <span class="var type1" id="S41T5U645">Thi_Ptr</span>, <span class="var type1" id="S24T1U646">var_length</span>, <span class="var type1" id="S34T5U647">c_ind</span>, <span class="var type1" id="S66T5U648">Ch_Ptr</span>, <span class="var type1" id="S18T1U649">ierr</span>,<span class="var type1" id="S20T3U650">herr</span>,<span class="var type1" id="S17T1U651">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,204" id="srcline204">204</a></span><span class="line"><span class="mxinfo " id="T5:U372"><span class="extrinsicFcn" id="F199N3:B654">calllib</span>(<span class="mxinfo " id="T6:U373"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U374"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U657">handle_c</span>, <span class="var type1" id="S30T5U658">pt_ind</span>, <span class="var type1" id="S37T5U659">p_c_Ptr</span>, <span class="var type1" id="S42T5U660">Tci_Ptr</span>, <span class="var type1" id="S24T1U661">var_length</span>, <span class="var type1" id="S34T5U662">c_ind</span>, <span class="var type1" id="S67T5U663">Cc_Ptr</span>, <span class="var type1" id="S18T1U664">ierr</span>,<span class="var type1" id="S20T3U665">herr</span>,<span class="var type1" id="S17T1U666">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,205" id="srcline205">205</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,206" id="srcline206">206</a></span><span class="line"><span class="comment">% Set Ch &amp; Cc to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,207" id="srcline207">207</a></span><span class="line"><span class="mxinfo " id="T1:U385"><span class="var type1" id="S64T1U669">Ch</span> = <span class="mxinfo " id="T5:U387"><span class="extrinsicFcn" id="F200N7:B671">get</span>(<span class="var type1" id="S66T5U672">Ch_Ptr</span>,<span class="mxinfo " id="T13:U389"><span class="string">'Value'</span></span>)</span></span>;   <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,208" id="srcline208">208</a></span><span class="line"><span class="mxinfo " id="T1:U390"><span class="var type1" id="S65T1U676">Cc</span> = <span class="mxinfo " id="T5:U392"><span class="extrinsicFcn" id="F201N7:B678">get</span>(<span class="var type1" id="S67T5U679">Cc_Ptr</span>,<span class="mxinfo " id="T13:U394"><span class="string">'Value'</span></span>)</span></span>;   <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,209" id="srcline209">209</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,210" id="srcline210">210</a></span><span class="line"><span class="comment">% If the fluid is withing 1e-4 units of the vaporization point then the </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,211" id="srcline211">211</a></span><span class="line"><span class="comment">% will return an inaccurate values. If that happens then the specific heat </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,212" id="srcline212">212</a></span><span class="line"><span class="comment">% will be set to inf so its temperature will not change even though heat is</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,213" id="srcline213">213</a></span><span class="line"><span class="comment">% exchanged.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,214" id="srcline214">214</a></span><span class="line"><span class="mxinfo " id="T17:U395"><span class="mxinfo " id="T17:U396"><span class="var type1" id="S64T1U684">Ch</span>(<span class="mxinfo " id="T15:U398"><span class="mxinfo " id="T1:U399">abs(<span class="mxinfo " id="T1:U400"><span class="var type1" id="S39T1U689">Thi</span> - <span class="var type1" id="S51T1U690">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U403">1e-4</span></span>)</span> = <span class="mxinfo " id="T1:U404">inf</span></span>;    <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,215" id="srcline215">215</a></span><span class="line"><span class="mxinfo " id="T17:U405"><span class="mxinfo " id="T17:U406"><span class="var type1" id="S65T1U697">Cc</span>(<span class="mxinfo " id="T15:U408"><span class="mxinfo " id="T1:U409">abs(<span class="mxinfo " id="T1:U410"><span class="var type1" id="S40T1U702">Tci</span> - <span class="var type1" id="S52T1U703">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U413">1e-4</span></span>)</span> = <span class="mxinfo " id="T1:U414">inf</span></span>;    <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,216" id="srcline216">216</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,217" id="srcline217">217</a></span><span class="line"><span class="comment">% Calculate the heat capacity rates of the hot and cool fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,218" id="srcline218">218</a></span><span class="line"><span class="mxinfo " id="T1:U415"><span class="var type1" id="S70T1U709">Ch_rate</span> = <span class="mxinfo " id="T1:U417"><span class="var type1" id="S64T1U711">Ch</span> .* <span class="var type1" id="S6T1U712">m_dot_h</span></span></span>;     <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,219" id="srcline219">219</a></span><span class="line"><span class="mxinfo " id="T1:U420"><span class="var type1" id="S71T1U715">Cc_rate</span> = <span class="mxinfo " id="T1:U422"><span class="var type1" id="S65T1U717">Cc</span> .* <span class="var type1" id="S9T1U718">m_dot_c</span></span></span>;     <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,220" id="srcline220">220</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,221" id="srcline221">221</a></span><span class="line"><span class="comment">% Determine the maximum and minimum of the two heat capacity rates</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,222" id="srcline222">222</a></span><span class="line"><span class="mxinfo " id="T1:U425"><span class="var type1" id="S72T1U721">Cmax</span> = <span class="var type1" id="S70T1U722">Ch_rate</span></span>; <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,223" id="srcline223">223</a></span><span class="line"><span class="mxinfo " id="T17:U428"><span class="mxinfo " id="T17:U429"><span class="var type1" id="S72T1U726">Cmax</span>(<span class="mxinfo " id="T15:U431"><span class="var type1" id="S70T1U728">Ch_rate</span> &lt; <span class="var type1" id="S71T1U729">Cc_rate</span></span>)</span> = <span class="var type1" id="S71T1U731">Cc_rate</span>(<span class="mxinfo " id="T15:U435"><span class="var type1" id="S70T1U733">Ch_rate</span> &lt; <span class="var type1" id="S71T1U734">Cc_rate</span></span>)</span>;   <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,224" id="srcline224">224</a></span><span class="line"><span class="mxinfo " id="T1:U438"><span class="var type1" id="S73T1U737">Cmin</span> = <span class="var type1" id="S70T1U738">Ch_rate</span></span>; <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,225" id="srcline225">225</a></span><span class="line"><span class="mxinfo " id="T17:U441"><span class="mxinfo " id="T17:U442"><span class="var type1" id="S73T1U742">Cmin</span>(<span class="mxinfo " id="T15:U444"><span class="var type1" id="S70T1U744">Ch_rate</span> &gt; <span class="var type1" id="S71T1U745">Cc_rate</span></span>)</span> = <span class="var type1" id="S71T1U747">Cc_rate</span>(<span class="mxinfo " id="T15:U448"><span class="var type1" id="S70T1U749">Ch_rate</span> &gt; <span class="var type1" id="S71T1U750">Cc_rate</span></span>)</span>;   <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,226" id="srcline226">226</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,227" id="srcline227">227</a></span><span class="line"><span class="comment">% Calcluate the heat capacity rate ratio </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,228" id="srcline228">228</a></span><span class="line"><span class="mxinfo " id="T1:U451"><span class="var type1" id="S74T1U753">Cr</span> = <span class="mxinfo " id="T1:U453"><span class="var type1" id="S73T1U755">Cmin</span>./<span class="var type1" id="S72T1U756">Cmax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,229" id="srcline229">229</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,230" id="srcline230">230</a></span><span class="line"><span class="comment">% unitA is the size of heat exchanger area(m2) each iteration of the script</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,231" id="srcline231">231</a></span><span class="line"><span class="comment">% uses for calculating NTU</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,232" id="srcline232">232</a></span><span class="line"><span class="comment">% unitA = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,233" id="srcline233">233</a></span><span class="line"><span class="mxinfo " id="T1:U456"><span class="var type1" id="S75T1U759">unitA</span> = <span class="mxinfo " id="T1:U458"><span class="var type1" id="S15T1U761">A</span> .* <span class="mxinfo " id="T1:U460">ones(<span class="var type1" id="S24T1U764">var_length</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,234" id="srcline234">234</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,235" id="srcline235">235</a></span><span class="line"><span class="comment">% Calculate the number of transfer units of the heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,236" id="srcline236">236</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U462">any(<span class="mxinfo " id="T15:U463"><span class="var type1" id="S15T1U771">A</span> &lt; <span class="var type1" id="S75T1U772">unitA</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,237" id="srcline237">237</a></span><span class="line">    <span class="mxinfo " id="T1:U466"><span class="var type1" id="S75T1U775">unitA</span> = <span class="mxinfo " id="T1:U468"><span class="var type1" id="S15T1U777">A</span> .* <span class="mxinfo " id="T1:U470">ones(<span class="var type1" id="S24T1U780">var_length</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,238" id="srcline238">238</a></span><span class="line"><span class="comment">%     NTU = U * A / Cmin</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,239" id="srcline239">239</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,240" id="srcline240">240</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,241" id="srcline241">241</a></span><span class="line"><span class="mxinfo " id="T1:U472"><span class="var type1" id="S77T1U784">NTU</span> = <span class="mxinfo " id="T1:U474"><span class="mxinfo " id="T1:U475"><span class="var type1" id="S14T1U787">U</span> * <span class="var type1" id="S75T1U788">unitA</span></span> ./ <span class="var type1" id="S73T1U789">Cmin</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,242" id="srcline242">242</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,243" id="srcline243">243</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,244" id="srcline244">244</a></span><span class="line"><span class="comment">% Calculate effectiveness based on type of heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,245" id="srcline245">245</a></span><span class="line"><span class="keyword">switch</span> <span class="var type1" id="S13T1U791">HeatExType</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,246" id="srcline246">246</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'counter'</span>  <span class="comment">% If the heat exchanger is counter-flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,247" id="srcline247">247</a></span><span class="line">        <span class="var type0" id="S78T0U796">effectiveness</span> = (1 - exp(-<span class="var type0" id="S77T0U805">NTU</span>.*(1 - <span class="var type0" id="S74T0U809">Cr</span>))) ./ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,248" id="srcline248">248</a></span><span class="line">                        (1 - <span class="var type0" id="S74T0U814">Cr</span>.*exp(-<span class="var type0" id="S77T0U819">NTU</span>.*(1 - <span class="var type0" id="S74T0U823">Cr</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="28,249" id="srcline249">249</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'parallel'</span> <span class="comment">% If the heat exchanger is parallel-flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,250" id="srcline250">250</a></span><span class="line">        <span class="var type0" id="S78T0U828">effectiveness</span> = (1 - exp(-<span class="var type0" id="S77T0U837">NTU</span>.*(1 + <span class="var type0" id="S74T0U841">Cr</span>))) ./ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,251" id="srcline251">251</a></span><span class="line">                        (1 + <span class="var type0" id="S74T0U845">Cr</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="28,252" id="srcline252">252</a></span><span class="line">    <span class="keyword">otherwise</span>       <span class="comment">% If not exchanger specified</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,253" id="srcline253">253</a></span><span class="line"><span class="comment">%         warning('No heat exchanger type specified, therefore no heat is exchanged.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,254" id="srcline254">254</a></span><span class="line">        <span class="mxinfo " id="T1:U480"><span class="var type1" id="S78T1U849">effectiveness</span> = <span class="mxinfo " id="T1:U482">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,255" id="srcline255">255</a></span><span class="line"><span class="keyword">end</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="28,256" id="srcline256">256</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,257" id="srcline257">257</a></span><span class="line"><span class="comment">% % However if the Cr is 0 (Cmax is inf) then effectiveness is calcluated</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,258" id="srcline258">258</a></span><span class="line"><span class="comment">% % regardless of the heat exchanger flow.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,259" id="srcline259">259</a></span><span class="line"><span class="comment">% if Cr == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,260" id="srcline260">260</a></span><span class="line"><span class="comment">%     effectiveness = 1 - exp(-NTU);</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,261" id="srcline261">261</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,262" id="srcline262">262</a></span><span class="line"><span class="comment">% effectiveness;</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,263" id="srcline263">263</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,264" id="srcline264">264</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,265" id="srcline265">265</a></span><span class="line"><span class="comment">% Maximum energy transfer rate is equal for an infinite length heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,266" id="srcline266">266</a></span><span class="line"><span class="comment">% exchanger is equal to Cmin multiplied with the difference in inlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,267" id="srcline267">267</a></span><span class="line"><span class="comment">% temperatures. The actual energy transfer rate is the maximum rate</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,268" id="srcline268">268</a></span><span class="line"><span class="comment">% multiplied by the effectiveness (Assuming no heat loss).</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,269" id="srcline269">269</a></span><span class="line"><span class="mxinfo " id="T1:U483"><span class="var type1" id="S2T1U853">P</span> = <span class="mxinfo " id="T1:U485"><span class="mxinfo " id="T1:U486"><span class="var type1" id="S78T1U856">effectiveness</span>.*<span class="var type1" id="S73T1U857">Cmin</span></span>.*(<span class="mxinfo " id="T1:U489"><span class="var type1" id="S39T1U860">Thi</span> - <span class="var type1" id="S40T1U861">Tci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,270" id="srcline270">270</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,271" id="srcline271">271</a></span><span class="line"><span class="comment">% The change in temperature is calculated for both sides by dividing the</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,272" id="srcline272">272</a></span><span class="line"><span class="comment">% energy tranfer rate by the heat capacity rates for both sides. This</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,273" id="srcline273">273</a></span><span class="line"><span class="comment">% assumes the energy transfer rate is the same for both sides.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,274" id="srcline274">274</a></span><span class="line"><span class="mxinfo " id="T1:U492"><span class="var type1" id="S80T1U864">deltaTh</span> = <span class="mxinfo " id="T1:U494"><span class="var type1" id="S2T1U866">P</span>./<span class="var type1" id="S70T1U867">Ch_rate</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,275" id="srcline275">275</a></span><span class="line"><span class="mxinfo " id="T1:U497"><span class="var type1" id="S81T1U870">deltaTc</span> = <span class="mxinfo " id="T1:U499"><span class="var type1" id="S2T1U872">P</span>./<span class="var type1" id="S71T1U873">Cc_rate</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,276" id="srcline276">276</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,277" id="srcline277">277</a></span><span class="line"><span class="comment">% The outlet temperatures are caluctaed by subtracting the change in</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,278" id="srcline278">278</a></span><span class="line"><span class="comment">% temperature from the hot fluid inlet temperature and adding the change in</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,279" id="srcline279">279</a></span><span class="line"><span class="comment">% temperature from the cool fluid inlet temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,280" id="srcline280">280</a></span><span class="line"><span class="mxinfo " id="T1:U502"><span class="var type1" id="S82T1U876">Tho</span> = <span class="mxinfo " id="T1:U504"><span class="var type1" id="S39T1U878">Thi</span> - <span class="var type1" id="S80T1U879">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,281" id="srcline281">281</a></span><span class="line"><span class="mxinfo " id="T1:U507"><span class="var type1" id="S83T1U882">Tco</span> = <span class="mxinfo " id="T1:U509"><span class="var type1" id="S40T1U884">Tci</span> + <span class="var type1" id="S81T1U885">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,282" id="srcline282">282</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,283" id="srcline283">283</a></span><span class="line"><span class="comment">% Determine Hho and Hco values based off of Tho and Tco values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,284" id="srcline284">284</a></span><span class="line"><span class="comment">% Initialize Hho and Hco values and pointers and Tho &amp; Tco pointers</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,285" id="srcline285">285</a></span><span class="line"><span class="mxinfo " id="T5:U512"><span class="var type1" id="S84T5U888">Tho_Ptr</span> = <span class="mxinfo " id="T5:U514"><span class="extrinsicFcn" id="F202N8:B890">libpointer</span>(<span class="mxinfo " id="T9:U515"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U892">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,286" id="srcline286">286</a></span><span class="line"><span class="mxinfo " id="T5:U517"><span class="var type1" id="S85T5U895">Tco_Ptr</span> = <span class="mxinfo " id="T5:U519"><span class="extrinsicFcn" id="F203N8:B897">libpointer</span>(<span class="mxinfo " id="T9:U520"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S83T1U899">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,287" id="srcline287">287</a></span><span class="line"><span class="mxinfo " id="T1:U522"><span class="var type1" id="S86T1U902">Hho</span> = <span class="mxinfo " id="T1:U524">zeros(<span class="var type1" id="S24T1U905">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,288" id="srcline288">288</a></span><span class="line"><span class="mxinfo " id="T1:U526"><span class="var type1" id="S87T1U909">Hco</span> = <span class="mxinfo " id="T1:U528">zeros(<span class="var type1" id="S24T1U912">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,289" id="srcline289">289</a></span><span class="line"><span class="mxinfo " id="T5:U530"><span class="var type1" id="S88T5U916">Hho_Ptr</span> = <span class="mxinfo " id="T5:U532"><span class="extrinsicFcn" id="F204N8:B918">libpointer</span>(<span class="mxinfo " id="T9:U533"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S86T1U920">Hho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo " id="T5:U535"><span class="var type1" id="S89T5U923">Hco_Ptr</span> = <span class="mxinfo " id="T5:U537"><span class="extrinsicFcn" id="F205N8:B925">libpointer</span>(<span class="mxinfo " id="T9:U538"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S87T1U927">Hco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,291" id="srcline291">291</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,292" id="srcline292">292</a></span><span class="line"><span class="comment">% Update values located at Hho and Hco pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,293" id="srcline293">293</a></span><span class="line"><span class="mxinfo " id="T5:U540"><span class="extrinsicFcn" id="F206N3:B930">calllib</span>(<span class="mxinfo " id="T6:U541"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U542"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U933">handle_h</span>, <span class="var type1" id="S30T5U934">pt_ind</span>, <span class="var type1" id="S35T5U935">p_h_Ptr</span>, <span class="var type1" id="S84T5U936">Tho_Ptr</span>, <span class="var type1" id="S24T1U937">var_length</span>, <span class="var type1" id="S33T5U938">h_ind</span>, <span class="var type1" id="S88T5U939">Hho_Ptr</span>, <span class="var type1" id="S18T1U940">ierr</span>,<span class="var type1" id="S20T3U941">herr</span>,<span class="var type1" id="S17T1U942">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,294" id="srcline294">294</a></span><span class="line"><span class="mxinfo " id="T5:U553"><span class="extrinsicFcn" id="F207N3:B945">calllib</span>(<span class="mxinfo " id="T6:U554"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U555"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U948">handle_c</span>, <span class="var type1" id="S30T5U949">pt_ind</span>, <span class="var type1" id="S37T5U950">p_c_Ptr</span>, <span class="var type1" id="S85T5U951">Tco_Ptr</span>, <span class="var type1" id="S24T1U952">var_length</span>, <span class="var type1" id="S33T5U953">h_ind</span>, <span class="var type1" id="S89T5U954">Hco_Ptr</span>, <span class="var type1" id="S18T1U955">ierr</span>,<span class="var type1" id="S20T3U956">herr</span>,<span class="var type1" id="S17T1U957">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,295" id="srcline295">295</a></span><span class="line"><span class="comment">% Set Hho &amp; Hco to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,296" id="srcline296">296</a></span><span class="line"><span class="mxinfo " id="T1:U566"><span class="var type1" id="S86T1U960">Hho</span> = <span class="mxinfo " id="T5:U568"><span class="extrinsicFcn" id="F208N7:B962">get</span>(<span class="var type1" id="S88T5U963">Hho_Ptr</span>,<span class="mxinfo " id="T13:U570"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,297" id="srcline297">297</a></span><span class="line"><span class="mxinfo " id="T1:U571"><span class="var type1" id="S87T1U967">Hco</span> = <span class="mxinfo " id="T5:U573"><span class="extrinsicFcn" id="F209N7:B969">get</span>(<span class="var type1" id="S89T5U970">Hco_Ptr</span>,<span class="mxinfo " id="T13:U575"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,298" id="srcline298">298</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,299" id="srcline299">299</a></span><span class="line"><span class="comment">% The coolprop return may be inaccurate if Tho = vaporization temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,300" id="srcline300">300</a></span><span class="line"><span class="comment">% For those values Ho = Hi - P/m_dot</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,301" id="srcline301">301</a></span><span class="line"><span class="mxinfo " id="T17:U576"><span class="mxinfo " id="T17:U577"><span class="var type1" id="S86T1U975">Hho</span>(<span class="mxinfo " id="T15:U579"><span class="mxinfo " id="T1:U580">abs(<span class="mxinfo " id="T1:U581"><span class="var type1" id="S39T1U980">Thi</span> - <span class="var type1" id="S51T1U981">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U584">1e-4</span></span>)</span> =  <span class="mxinfo " id="T17:U585"><span class="var type1" id="S43T1U985">Hhi</span>(<span class="mxinfo " id="T15:U587"><span class="mxinfo " id="T1:U588">abs(<span class="mxinfo " id="T1:U589"><span class="var type1" id="S39T1U990">Thi</span> - <span class="var type1" id="S51T1U991">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U592">1e-4</span></span>) <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,302" id="srcline302">302</a></span><span class="line">    - <span class="mxinfo " id="T17:U593"><span class="mxinfo " id="T17:U594"><span class="var type1" id="S2T1U995">P</span>(<span class="mxinfo " id="T15:U596"><span class="mxinfo " id="T1:U597">abs(<span class="mxinfo " id="T1:U598"><span class="var type1" id="S39T1U1000">Thi</span> - <span class="var type1" id="S51T1U1001">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U601">1e-4</span></span>)</span>./<span class="mxinfo " id="T17:U602"><span class="var type1" id="S6T1U1004">m_dot_h</span>(<span class="mxinfo " id="T15:U604"><span class="mxinfo " id="T1:U605">abs(<span class="mxinfo " id="T1:U606"><span class="var type1" id="S39T1U1009">Thi</span> - <span class="var type1" id="S51T1U1010">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U609">1e-4</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,303" id="srcline303">303</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,304" id="srcline304">304</a></span><span class="line"><span class="comment">% The coolprop return may be inaccurate if Tco = vaporization temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,305" id="srcline305">305</a></span><span class="line"><span class="comment">% For those values Ho = Hi - P/m_dot</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,306" id="srcline306">306</a></span><span class="line"><span class="mxinfo " id="T17:U610"><span class="mxinfo " id="T17:U611"><span class="var type1" id="S87T1U1015">Hco</span>(<span class="mxinfo " id="T15:U613"><span class="mxinfo " id="T1:U614">abs(<span class="mxinfo " id="T1:U615"><span class="var type1" id="S40T1U1020">Tci</span> - <span class="var type1" id="S52T1U1021">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U618">1e-4</span></span>)</span> =  <span class="mxinfo " id="T17:U619"><span class="var type1" id="S45T1U1025">Hci</span>(<span class="mxinfo " id="T15:U621"><span class="mxinfo " id="T1:U622">abs(<span class="mxinfo " id="T1:U623"><span class="var type1" id="S40T1U1030">Tci</span> - <span class="var type1" id="S52T1U1031">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U626">1e-4</span></span>) <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,307" id="srcline307">307</a></span><span class="line">    - <span class="mxinfo " id="T17:U627"><span class="mxinfo " id="T17:U628"><span class="var type1" id="S2T1U1035">P</span>(<span class="mxinfo " id="T15:U630"><span class="mxinfo " id="T1:U631">abs(<span class="mxinfo " id="T1:U632"><span class="var type1" id="S40T1U1040">Tci</span> - <span class="var type1" id="S52T1U1041">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U635">1e-4</span></span>)</span>./<span class="mxinfo " id="T17:U636"><span class="var type1" id="S9T1U1044">m_dot_c</span>(<span class="mxinfo " id="T15:U638"><span class="mxinfo " id="T1:U639">abs(<span class="mxinfo " id="T1:U640"><span class="var type1" id="S40T1U1049">Tci</span> - <span class="var type1" id="S52T1U1050">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U643">1e-4</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,308" id="srcline308">308</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,309" id="srcline309">309</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,310" id="srcline310">310</a></span><span class="line"><span class="comment">% check if hot fluid begins to condense </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,311" id="srcline311">311</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U644">any(<span class="mxinfo " id="T15:U645"><span class="mxinfo " id="T15:U646"><span class="var type1" id="S86T1U1058">Hho</span> &lt;= <span class="var type1" id="S60T1U1059">Hvh_max</span></span> &amp; <span class="mxinfo " id="T15:U649"><span class="var type1" id="S43T1U1061">Hhi</span> &gt; <span class="var type1" id="S60T1U1062">Hvh_max</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,312" id="srcline312">312</a></span><span class="line"><span class="comment">% if Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,313" id="srcline313">313</a></span><span class="line">    <span class="mxinfo " id="T5:U652"><span class="autoExtrinsicFcn" id="F210N4:B1065">disp</span>(<span class="mxinfo " id="T18:U653"><span class="string">'~~~~~~~~~~~~~~~~~~~Condensation start~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,314" id="srcline314">314</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,315" id="srcline315">315</a></span><span class="line"><span class="comment">%     Get the indecies where condensation starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,316" id="srcline316">316</a></span><span class="line">    <span class="mxinfo " id="T15:U654"><span class="var type1" id="S91T15U1069">cond_start_ind</span> = (<span class="mxinfo " id="T15:U656"><span class="mxinfo " id="T15:U657"><span class="var type1" id="S86T1U1073">Hho</span> &lt;= <span class="var type1" id="S60T1U1074">Hvh_max</span></span> &amp; <span class="mxinfo " id="T15:U660"><span class="var type1" id="S43T1U1076">Hhi</span> &gt; <span class="var type1" id="S60T1U1077">Hvh_max</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,317" id="srcline317">317</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,318" id="srcline318">318</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to maximum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,319" id="srcline319">319</a></span><span class="line"><span class="comment">%     vaporization region (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,320" id="srcline320">320</a></span><span class="line">    <span class="mxinfo " id="T17:U663"><span class="mxinfo " id="T17:U664"><span class="var type1" id="S86T1U1081">Hho</span>(<span class="var type1" id="S91T15U1082">cond_start_ind</span>)</span> = <span class="var type1" id="S60T1U1084">Hvh_max</span>(<span class="var type1" id="S91T15U1085">cond_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,321" id="srcline321">321</a></span><span class="line">    <span class="mxinfo " id="T17:U669"><span class="mxinfo " id="T17:U670"><span class="var type1" id="S82T1U1089">Tho</span>(<span class="var type1" id="S91T15U1090">cond_start_ind</span>)</span> = <span class="var type1" id="S51T1U1092">Tvh</span>(<span class="var type1" id="S91T15U1093">cond_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,322" id="srcline322">322</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,323" id="srcline323">323</a></span><span class="line"><span class="comment">%     Calculate power needed to bring hot fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,324" id="srcline324">324</a></span><span class="line"><span class="comment">%     precondense for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,325" id="srcline325">325</a></span><span class="line">    <span class="mxinfo " id="T17:U675"><span class="var type1" id="S92T17U1096">P_init_to_precondense</span> = <span class="mxinfo " id="T17:U677">(<span class="mxinfo " id="T17:U678"><span class="var type1" id="S43T1U1101">Hhi</span>(<span class="var type1" id="S91T15U1102">cond_start_ind</span>) - <span class="var type1" id="S86T1U1104">Hho</span>(<span class="var type1" id="S91T15U1105">cond_start_ind</span>)</span>).*<span class="var type1" id="S6T1U1107">m_dot_h</span>(<span class="var type1" id="S91T15U1108">cond_start_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,326" id="srcline326">326</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,327" id="srcline327">327</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent cool fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,328" id="srcline328">328</a></span><span class="line">    <span class="mxinfo " id="T17:U685"><span class="var type1" id="S81T17U1111">deltaTc</span> = <span class="mxinfo " id="T17:U687"><span class="var type1" id="S92T17U1113">P_init_to_precondense</span>./<span class="mxinfo " id="T17:U689"><span class="var type1" id="S71T1U1115">Cc_rate</span>(<span class="var type1" id="S91T15U1116">cond_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,329" id="srcline329">329</a></span><span class="line"><span class="comment">%     Update relavent cool fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,330" id="srcline330">330</a></span><span class="line">    <span class="mxinfo " id="T17:U692"><span class="mxinfo " id="T17:U693"><span class="var type1" id="S83T1U1120">Tco</span>(<span class="var type1" id="S91T15U1121">cond_start_ind</span>)</span> = <span class="mxinfo " id="T17:U696"><span class="var type1" id="S40T1U1124">Tci</span>(<span class="var type1" id="S91T15U1125">cond_start_ind</span>) + <span class="var type1" id="S81T17U1126">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,331" id="srcline331">331</a></span><span class="line">    <span class="mxinfo " id="T5:U700"><span class="var type1" id="S85T5U1129">Tco_Ptr</span> = <span class="mxinfo " id="T5:U702"><span class="extrinsicFcn" id="F211N8:B1131">libpointer</span>(<span class="mxinfo " id="T9:U703"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S83T1U1133">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,332" id="srcline332">332</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,333" id="srcline333">333</a></span><span class="line"><span class="comment">%     Update H values for new cool output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,334" id="srcline334">334</a></span><span class="line">    <span class="mxinfo " id="T5:U705"><span class="extrinsicFcn" id="F212N3:B1136">calllib</span>(<span class="mxinfo " id="T6:U706"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U707"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1139">handle_c</span>, <span class="var type1" id="S30T5U1140">pt_ind</span>, <span class="var type1" id="S37T5U1141">p_c_Ptr</span>, <span class="var type1" id="S85T5U1142">Tco_Ptr</span>, <span class="var type1" id="S24T1U1143">var_length</span>, <span class="var type1" id="S33T5U1144">h_ind</span>, <span class="var type1" id="S89T5U1145">Hco_Ptr</span>, <span class="var type1" id="S18T1U1146">ierr</span>,<span class="var type1" id="S20T3U1147">herr</span>,<span class="var type1" id="S17T1U1148">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,335" id="srcline335">335</a></span><span class="line">    <span class="mxinfo " id="T1:U718"><span class="var type1" id="S87T1U1151">Hco</span> = <span class="mxinfo " id="T5:U720"><span class="extrinsicFcn" id="F213N7:B1153">get</span>(<span class="var type1" id="S89T5U1154">Hco_Ptr</span>,<span class="mxinfo " id="T13:U722"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,336" id="srcline336">336</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,337" id="srcline337">337</a></span><span class="line"><span class="comment">%     Calculate ratio of power to precondense state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,338" id="srcline338">338</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,339" id="srcline339">339</a></span><span class="line">    <span class="mxinfo " id="T17:U723"><span class="var type1" id="S93T17U1158">PowerFrac_Condense_over_NoCondense</span> = <span class="mxinfo " id="T17:U725"><span class="var type1" id="S92T17U1160">P_init_to_precondense</span>./<span class="mxinfo " id="T17:U727"><span class="var type1" id="S2T1U1162">P</span>(<span class="var type1" id="S91T15U1163">cond_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,340" id="srcline340">340</a></span><span class="line">    <span class="mxinfo " id="T17:U730"><span class="mxinfo " id="T17:U731"><span class="var type1" id="S75T1U1167">unitA</span>(<span class="var type1" id="S91T15U1168">cond_start_ind</span>)</span> = <span class="mxinfo " id="T17:U734"><span class="mxinfo " id="T17:U735"><span class="var type1" id="S75T1U1171">unitA</span>(<span class="var type1" id="S91T15U1172">cond_start_ind</span>)</span>*<span class="var type1" id="S93T17U1173">PowerFrac_Condense_over_NoCondense</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,341" id="srcline341">341</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,342" id="srcline342">342</a></span><span class="line">    <span class="mxinfo " id="T17:U739"><span class="mxinfo " id="T17:U740"><span class="var type1" id="S2T1U1177">P</span>(<span class="var type1" id="S91T15U1178">cond_start_ind</span>)</span> = <span class="var type1" id="S92T17U1179">P_init_to_precondense</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,343" id="srcline343">343</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,344" id="srcline344">344</a></span><span class="line"><span class="comment">% check if hot fluid finishes condensing    </span></span></span>
<span class="srcline"><span class="lineno"><a href="28,345" id="srcline345">345</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U744">any(<span class="mxinfo " id="T15:U745"><span class="mxinfo " id="T15:U746"><span class="var type1" id="S86T1U1185">Hho</span> &lt;= <span class="var type1" id="S55T1U1186">Hvh_min</span></span> &amp; <span class="mxinfo " id="T15:U749"><span class="var type1" id="S43T1U1188">Hhi</span> &gt; <span class="var type1" id="S55T1U1189">Hvh_min</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,346" id="srcline346">346</a></span><span class="line"><span class="comment">% elseif Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,347" id="srcline347">347</a></span><span class="line">    <span class="mxinfo " id="T5:U752"><span class="autoExtrinsicFcn" id="F214N4:B1192">disp</span>(<span class="mxinfo " id="T19:U753"><span class="string">'~~~~~~~~~~~~~~~~~~~~~~Condensation end~~~~~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,348" id="srcline348">348</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,349" id="srcline349">349</a></span><span class="line"><span class="comment">%     Get the indecies where condensation starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,350" id="srcline350">350</a></span><span class="line">    <span class="mxinfo " id="T15:U754"><span class="var type1" id="S94T15U1196">cond_end_ind</span> = (<span class="mxinfo " id="T15:U756"><span class="mxinfo " id="T15:U757"><span class="var type1" id="S86T1U1200">Hho</span> &lt;= <span class="var type1" id="S55T1U1201">Hvh_min</span></span> &amp; <span class="mxinfo " id="T15:U760"><span class="var type1" id="S43T1U1203">Hhi</span> &gt; <span class="var type1" id="S55T1U1204">Hvh_min</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,351" id="srcline351">351</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,352" id="srcline352">352</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to minimum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,353" id="srcline353">353</a></span><span class="line"><span class="comment">%     vaporization region (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,354" id="srcline354">354</a></span><span class="line">    <span class="mxinfo " id="T17:U763"><span class="mxinfo " id="T17:U764"><span class="var type1" id="S86T1U1208">Hho</span>(<span class="var type1" id="S94T15U1209">cond_end_ind</span>)</span> = <span class="var type1" id="S55T1U1211">Hvh_min</span>(<span class="var type1" id="S94T15U1212">cond_end_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,355" id="srcline355">355</a></span><span class="line">    <span class="mxinfo " id="T17:U769"><span class="mxinfo " id="T17:U770"><span class="var type1" id="S82T1U1216">Tho</span>(<span class="var type1" id="S94T15U1217">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U773"><span class="var type1" id="S51T1U1220">Tvh</span>(<span class="var type1" id="S94T15U1221">cond_end_ind</span>) - <span class="mxinfo " id="T1:U776">1e-4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,356" id="srcline356">356</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,357" id="srcline357">357</a></span><span class="line"><span class="comment">%     Calculate power needed to bring hot fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,358" id="srcline358">358</a></span><span class="line"><span class="comment">%     postcondense for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,359" id="srcline359">359</a></span><span class="line">    <span class="mxinfo " id="T17:U777"><span class="var type1" id="S95T17U1225">P_init_to_postcondense</span> = <span class="mxinfo " id="T17:U779">(<span class="mxinfo " id="T17:U780"><span class="var type1" id="S43T1U1230">Hhi</span>(<span class="var type1" id="S94T15U1231">cond_end_ind</span>) - <span class="var type1" id="S86T1U1233">Hho</span>(<span class="var type1" id="S94T15U1234">cond_end_ind</span>)</span>).*<span class="var type1" id="S6T1U1236">m_dot_h</span>(<span class="var type1" id="S94T15U1237">cond_end_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,360" id="srcline360">360</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,361" id="srcline361">361</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent cool fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,362" id="srcline362">362</a></span><span class="line">    <span class="mxinfo " id="T17:U787"><span class="var type1" id="S81T17U1240">deltaTc</span> = <span class="mxinfo " id="T17:U789"><span class="var type1" id="S95T17U1242">P_init_to_postcondense</span>./<span class="mxinfo " id="T17:U791"><span class="var type1" id="S71T1U1244">Cc_rate</span>(<span class="var type1" id="S94T15U1245">cond_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,363" id="srcline363">363</a></span><span class="line"><span class="comment">%     Update relavent cool fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,364" id="srcline364">364</a></span><span class="line">    <span class="mxinfo " id="T17:U794"><span class="mxinfo " id="T17:U795"><span class="var type1" id="S83T1U1249">Tco</span>(<span class="var type1" id="S94T15U1250">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U798"><span class="var type1" id="S40T1U1253">Tci</span>(<span class="var type1" id="S94T15U1254">cond_end_ind</span>) + <span class="var type1" id="S81T17U1255">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,365" id="srcline365">365</a></span><span class="line">    <span class="mxinfo " id="T5:U802"><span class="var type1" id="S85T5U1258">Tco_Ptr</span> = <span class="mxinfo " id="T5:U804"><span class="extrinsicFcn" id="F215N8:B1260">libpointer</span>(<span class="mxinfo " id="T9:U805"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S83T1U1262">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,366" id="srcline366">366</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,367" id="srcline367">367</a></span><span class="line"><span class="comment">%     Update H values for new cool output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,368" id="srcline368">368</a></span><span class="line">    <span class="mxinfo " id="T5:U807"><span class="extrinsicFcn" id="F216N3:B1265">calllib</span>(<span class="mxinfo " id="T6:U808"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U809"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1268">handle_c</span>, <span class="var type1" id="S30T5U1269">pt_ind</span>, <span class="var type1" id="S37T5U1270">p_c_Ptr</span>, <span class="var type1" id="S85T5U1271">Tco_Ptr</span>, <span class="var type1" id="S24T1U1272">var_length</span>, <span class="var type1" id="S33T5U1273">h_ind</span>, <span class="var type1" id="S89T5U1274">Hco_Ptr</span>, <span class="var type1" id="S18T1U1275">ierr</span>,<span class="var type1" id="S20T3U1276">herr</span>,<span class="var type1" id="S17T1U1277">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,369" id="srcline369">369</a></span><span class="line">    <span class="mxinfo " id="T1:U820"><span class="var type1" id="S87T1U1280">Hco</span> = <span class="mxinfo " id="T5:U822"><span class="extrinsicFcn" id="F217N7:B1282">get</span>(<span class="var type1" id="S89T5U1283">Hco_Ptr</span>,<span class="mxinfo " id="T13:U824"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,370" id="srcline370">370</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,371" id="srcline371">371</a></span><span class="line"><span class="comment">%     Calculate ratio of power to postcondense state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,372" id="srcline372">372</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,373" id="srcline373">373</a></span><span class="line">    <span class="mxinfo " id="T17:U825"><span class="var type1" id="S93T17U1287">PowerFrac_Condense_over_NoCondense</span> = <span class="mxinfo " id="T17:U827"><span class="var type1" id="S95T17U1289">P_init_to_postcondense</span>./<span class="mxinfo " id="T17:U829"><span class="var type1" id="S2T1U1291">P</span>(<span class="var type1" id="S94T15U1292">cond_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,374" id="srcline374">374</a></span><span class="line">    <span class="mxinfo " id="T17:U832"><span class="mxinfo " id="T17:U833"><span class="var type1" id="S75T1U1296">unitA</span>(<span class="var type1" id="S94T15U1297">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U836"><span class="mxinfo " id="T17:U837"><span class="var type1" id="S75T1U1300">unitA</span>(<span class="var type1" id="S94T15U1301">cond_end_ind</span>)</span>*<span class="var type1" id="S93T17U1302">PowerFrac_Condense_over_NoCondense</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,375" id="srcline375">375</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,376" id="srcline376">376</a></span><span class="line">    <span class="mxinfo " id="T17:U841"><span class="mxinfo " id="T17:U842"><span class="var type1" id="S2T1U1306">P</span>(<span class="var type1" id="S94T15U1307">cond_end_ind</span>)</span> = <span class="var type1" id="S95T17U1308">P_init_to_postcondense</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,377" id="srcline377">377</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="28,378" id="srcline378">378</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,379" id="srcline379">379</a></span><span class="line"><span class="comment">% else check if cool fluid begins to vaporize</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,380" id="srcline380">380</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U846">any(<span class="mxinfo " id="T15:U847"><span class="mxinfo " id="T15:U848"><span class="var type1" id="S87T1U1314">Hco</span> &gt;= <span class="var type1" id="S56T1U1315">Hvc_min</span></span> &amp; <span class="mxinfo " id="T15:U851"><span class="var type1" id="S45T1U1317">Hci</span> &lt; <span class="var type1" id="S56T1U1318">Hvc_min</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,381" id="srcline381">381</a></span><span class="line"><span class="comment">% elseif Tco &gt;= Tvc &amp;&amp; Tci &lt;= Tvc</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,382" id="srcline382">382</a></span><span class="line">   <span class="mxinfo " id="T5:U854"><span class="autoExtrinsicFcn" id="F218N4:B1321">disp</span>(<span class="mxinfo " id="T20:U855"><span class="string">'~~~~~~~~~~~~~~~~~~~Vaporization start~~~~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,383" id="srcline383">383</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,384" id="srcline384">384</a></span><span class="line"><span class="comment">%     Get the indecies where vaporization starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,385" id="srcline385">385</a></span><span class="line">    <span class="mxinfo " id="T15:U856"><span class="var type1" id="S96T15U1325">vap_start_ind</span> = (<span class="mxinfo " id="T15:U858"><span class="mxinfo " id="T15:U859"><span class="var type1" id="S87T1U1329">Hco</span> &gt;= <span class="var type1" id="S56T1U1330">Hvc_min</span></span> &amp; <span class="mxinfo " id="T15:U862"><span class="var type1" id="S45T1U1332">Hci</span> &lt; <span class="var type1" id="S56T1U1333">Hvc_min</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,386" id="srcline386">386</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,387" id="srcline387">387</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to minimum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,388" id="srcline388">388</a></span><span class="line"><span class="comment">%     vaporization region (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,389" id="srcline389">389</a></span><span class="line">    <span class="mxinfo " id="T17:U865"><span class="mxinfo " id="T17:U866"><span class="var type1" id="S87T1U1337">Hco</span>(<span class="var type1" id="S96T15U1338">vap_start_ind</span>)</span> = <span class="var type1" id="S56T1U1340">Hvc_min</span>(<span class="var type1" id="S96T15U1341">vap_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,390" id="srcline390">390</a></span><span class="line">    <span class="mxinfo " id="T17:U871"><span class="mxinfo " id="T17:U872"><span class="var type1" id="S83T1U1345">Tco</span>(<span class="var type1" id="S96T15U1346">vap_start_ind</span>)</span> = <span class="var type1" id="S52T1U1348">Tvc</span>(<span class="var type1" id="S96T15U1349">vap_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,391" id="srcline391">391</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,392" id="srcline392">392</a></span><span class="line"><span class="comment">%     Calculate power needed to bring cool fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,393" id="srcline393">393</a></span><span class="line"><span class="comment">%     prevaporization for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,394" id="srcline394">394</a></span><span class="line">    <span class="mxinfo " id="T17:U877"><span class="var type1" id="S97T17U1352">P_init_to_prevap</span> = <span class="mxinfo " id="T17:U879">(<span class="mxinfo " id="T17:U880"><span class="var type1" id="S87T1U1357">Hco</span>(<span class="var type1" id="S96T15U1358">vap_start_ind</span>) - <span class="var type1" id="S45T1U1360">Hci</span>(<span class="var type1" id="S96T15U1361">vap_start_ind</span>)</span>).*<span class="var type1" id="S9T1U1363">m_dot_c</span>(<span class="var type1" id="S96T15U1364">vap_start_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,395" id="srcline395">395</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,396" id="srcline396">396</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent hot fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,397" id="srcline397">397</a></span><span class="line">    <span class="mxinfo " id="T17:U887"><span class="var type1" id="S80T17U1367">deltaTh</span> = <span class="mxinfo " id="T17:U889"><span class="var type1" id="S97T17U1369">P_init_to_prevap</span>./<span class="mxinfo " id="T17:U891"><span class="var type1" id="S70T1U1371">Ch_rate</span>(<span class="var type1" id="S96T15U1372">vap_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,398" id="srcline398">398</a></span><span class="line"><span class="comment">%     Update relavent hot fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,399" id="srcline399">399</a></span><span class="line">    <span class="mxinfo " id="T17:U894"><span class="mxinfo " id="T17:U895"><span class="var type1" id="S82T1U1376">Tho</span>(<span class="var type1" id="S96T15U1377">vap_start_ind</span>)</span> = <span class="mxinfo " id="T17:U898"><span class="var type1" id="S39T1U1380">Thi</span>(<span class="var type1" id="S96T15U1381">vap_start_ind</span>) - <span class="var type1" id="S80T17U1382">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,400" id="srcline400">400</a></span><span class="line">    <span class="mxinfo " id="T5:U902"><span class="var type1" id="S84T5U1385">Tho_Ptr</span> = <span class="mxinfo " id="T5:U904"><span class="extrinsicFcn" id="F219N8:B1387">libpointer</span>(<span class="mxinfo " id="T9:U905"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U1389">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,401" id="srcline401">401</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,402" id="srcline402">402</a></span><span class="line"><span class="comment">%     Update H values for new hot output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,403" id="srcline403">403</a></span><span class="line">    <span class="mxinfo " id="T5:U907"><span class="extrinsicFcn" id="F220N3:B1392">calllib</span>(<span class="mxinfo " id="T6:U908"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U909"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1395">handle_h</span>, <span class="var type1" id="S30T5U1396">pt_ind</span>, <span class="var type1" id="S35T5U1397">p_h_Ptr</span>, <span class="var type1" id="S84T5U1398">Tho_Ptr</span>, <span class="var type1" id="S24T1U1399">var_length</span>, <span class="var type1" id="S33T5U1400">h_ind</span>, <span class="var type1" id="S88T5U1401">Hho_Ptr</span>, <span class="var type1" id="S18T1U1402">ierr</span>,<span class="var type1" id="S20T3U1403">herr</span>,<span class="var type1" id="S17T1U1404">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,404" id="srcline404">404</a></span><span class="line">    <span class="mxinfo " id="T1:U920"><span class="var type1" id="S86T1U1407">Hho</span> = <span class="mxinfo " id="T5:U922"><span class="extrinsicFcn" id="F221N7:B1409">get</span>(<span class="var type1" id="S88T5U1410">Hho_Ptr</span>,<span class="mxinfo " id="T13:U924"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,405" id="srcline405">405</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,406" id="srcline406">406</a></span><span class="line"><span class="comment">%     Calculate ratio of power to prevaporize state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,407" id="srcline407">407</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,408" id="srcline408">408</a></span><span class="line">    <span class="mxinfo " id="T17:U925"><span class="var type1" id="S98T17U1414">PowerFrac_Vaporize_over_NoVaporize</span> = <span class="mxinfo " id="T17:U927"><span class="var type1" id="S97T17U1416">P_init_to_prevap</span>./<span class="mxinfo " id="T17:U929"><span class="var type1" id="S2T1U1418">P</span>(<span class="var type1" id="S96T15U1419">vap_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,409" id="srcline409">409</a></span><span class="line">    <span class="mxinfo " id="T17:U932"><span class="mxinfo " id="T17:U933"><span class="var type1" id="S75T1U1423">unitA</span>(<span class="var type1" id="S96T15U1424">vap_start_ind</span>)</span> = <span class="mxinfo " id="T17:U936"><span class="var type1" id="S75T1U1427">unitA</span>(<span class="var type1" id="S96T15U1428">vap_start_ind</span>).*<span class="var type1" id="S98T17U1429">PowerFrac_Vaporize_over_NoVaporize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,410" id="srcline410">410</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,411" id="srcline411">411</a></span><span class="line">    <span class="mxinfo " id="T17:U940"><span class="mxinfo " id="T17:U941"><span class="var type1" id="S2T1U1433">P</span>(<span class="var type1" id="S96T15U1434">vap_start_ind</span>)</span> = <span class="var type1" id="S97T17U1435">P_init_to_prevap</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,412" id="srcline412">412</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,413" id="srcline413">413</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,414" id="srcline414">414</a></span><span class="line"><span class="comment">% check if cool fluid finishes vaporizing</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,415" id="srcline415">415</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U945">any(<span class="mxinfo " id="T15:U946"><span class="mxinfo " id="T15:U947"><span class="var type1" id="S87T1U1441">Hco</span> &gt;= <span class="var type1" id="S61T1U1442">Hvc_max</span></span> &amp; <span class="mxinfo " id="T15:U950"><span class="var type1" id="S45T1U1444">Hci</span> &lt; <span class="var type1" id="S61T1U1445">Hvc_max</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,416" id="srcline416">416</a></span><span class="line"><span class="comment">% elseif Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,417" id="srcline417">417</a></span><span class="line">    <span class="mxinfo " id="T5:U953"><span class="autoExtrinsicFcn" id="F222N4:B1448">disp</span>(<span class="mxinfo " id="T21:U954"><span class="string">'~~~~~~~~~~~~~~~~Vaporization end~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,418" id="srcline418">418</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,419" id="srcline419">419</a></span><span class="line"><span class="comment">%     Get the indecies where vaporization ends</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,420" id="srcline420">420</a></span><span class="line">    <span class="mxinfo " id="T15:U955"><span class="var type1" id="S99T15U1452">vap_end_ind</span> = (<span class="mxinfo " id="T15:U957"><span class="mxinfo " id="T15:U958"><span class="var type1" id="S87T1U1456">Hco</span> &gt;= <span class="var type1" id="S61T1U1457">Hvc_max</span></span> &amp; <span class="mxinfo " id="T15:U961"><span class="var type1" id="S45T1U1459">Hci</span> &lt; <span class="var type1" id="S61T1U1460">Hvc_max</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,421" id="srcline421">421</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,422" id="srcline422">422</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to maximum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,423" id="srcline423">423</a></span><span class="line"><span class="comment">%     vaporization region (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,424" id="srcline424">424</a></span><span class="line">    <span class="mxinfo " id="T17:U964"><span class="mxinfo " id="T17:U965"><span class="var type1" id="S87T1U1464">Hco</span>(<span class="var type1" id="S99T15U1465">vap_end_ind</span>)</span> = <span class="var type1" id="S61T1U1467">Hvc_max</span>(<span class="var type1" id="S99T15U1468">vap_end_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,425" id="srcline425">425</a></span><span class="line">    <span class="mxinfo " id="T17:U970"><span class="mxinfo " id="T17:U971"><span class="var type1" id="S83T1U1472">Tco</span>(<span class="var type1" id="S99T15U1473">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U974"><span class="var type1" id="S52T1U1476">Tvc</span>(<span class="var type1" id="S99T15U1477">vap_end_ind</span>) + <span class="mxinfo " id="T1:U977">1e-4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,426" id="srcline426">426</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,427" id="srcline427">427</a></span><span class="line"><span class="comment">%     Calculate power needed to bring cool fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,428" id="srcline428">428</a></span><span class="line"><span class="comment">%     postvaporization for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,429" id="srcline429">429</a></span><span class="line">    <span class="mxinfo " id="T17:U978"><span class="var type1" id="S100T17U1481">P_init_to_postvap</span> = <span class="mxinfo " id="T17:U980">(<span class="mxinfo " id="T17:U981"><span class="var type1" id="S87T1U1486">Hco</span>(<span class="var type1" id="S99T15U1487">vap_end_ind</span>) - <span class="var type1" id="S45T1U1489">Hci</span>(<span class="var type1" id="S99T15U1490">vap_end_ind</span>)</span>).*<span class="var type1" id="S9T1U1492">m_dot_c</span>(<span class="var type1" id="S99T15U1493">vap_end_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,430" id="srcline430">430</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,431" id="srcline431">431</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent hot fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,432" id="srcline432">432</a></span><span class="line">    <span class="mxinfo " id="T17:U988"><span class="var type1" id="S80T17U1496">deltaTh</span> = <span class="mxinfo " id="T17:U990"><span class="var type1" id="S100T17U1498">P_init_to_postvap</span>./<span class="mxinfo " id="T17:U992"><span class="var type1" id="S70T1U1500">Ch_rate</span>(<span class="var type1" id="S99T15U1501">vap_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,433" id="srcline433">433</a></span><span class="line"><span class="comment">%     Update relavent hot fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,434" id="srcline434">434</a></span><span class="line">    <span class="mxinfo " id="T17:U995"><span class="mxinfo " id="T17:U996"><span class="var type1" id="S82T1U1505">Tho</span>(<span class="var type1" id="S99T15U1506">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U999"><span class="var type1" id="S39T1U1509">Thi</span>(<span class="var type1" id="S99T15U1510">vap_end_ind</span>) - <span class="var type1" id="S80T17U1511">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,435" id="srcline435">435</a></span><span class="line">    <span class="mxinfo " id="T5:U1003"><span class="var type1" id="S84T5U1514">Tho_Ptr</span> = <span class="mxinfo " id="T5:U1005"><span class="extrinsicFcn" id="F223N8:B1516">libpointer</span>(<span class="mxinfo " id="T9:U1006"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U1518">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,436" id="srcline436">436</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,437" id="srcline437">437</a></span><span class="line"><span class="comment">%     Update H values for new hot output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,438" id="srcline438">438</a></span><span class="line">    <span class="mxinfo " id="T5:U1008"><span class="extrinsicFcn" id="F224N3:B1521">calllib</span>(<span class="mxinfo " id="T6:U1009"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1010"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1524">handle_h</span>, <span class="var type1" id="S30T5U1525">pt_ind</span>, <span class="var type1" id="S35T5U1526">p_h_Ptr</span>, <span class="var type1" id="S84T5U1527">Tho_Ptr</span>, <span class="var type1" id="S24T1U1528">var_length</span>, <span class="var type1" id="S33T5U1529">h_ind</span>, <span class="var type1" id="S88T5U1530">Hho_Ptr</span>, <span class="var type1" id="S18T1U1531">ierr</span>,<span class="var type1" id="S20T3U1532">herr</span>,<span class="var type1" id="S17T1U1533">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,439" id="srcline439">439</a></span><span class="line">    <span class="mxinfo " id="T1:U1021"><span class="var type1" id="S86T1U1536">Hho</span> = <span class="mxinfo " id="T5:U1023"><span class="extrinsicFcn" id="F225N7:B1538">get</span>(<span class="var type1" id="S88T5U1539">Hho_Ptr</span>,<span class="mxinfo " id="T13:U1025"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,440" id="srcline440">440</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,441" id="srcline441">441</a></span><span class="line"><span class="comment">%     Calculate ratio of power to prevaporize state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,442" id="srcline442">442</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,443" id="srcline443">443</a></span><span class="line">    <span class="mxinfo " id="T17:U1026"><span class="var type1" id="S98T17U1543">PowerFrac_Vaporize_over_NoVaporize</span> = <span class="mxinfo " id="T17:U1028"><span class="var type1" id="S100T17U1545">P_init_to_postvap</span>./<span class="mxinfo " id="T17:U1030"><span class="var type1" id="S2T1U1547">P</span>(<span class="var type1" id="S99T15U1548">vap_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,444" id="srcline444">444</a></span><span class="line">    <span class="mxinfo " id="T17:U1033"><span class="mxinfo " id="T17:U1034"><span class="var type1" id="S75T1U1552">unitA</span>(<span class="var type1" id="S99T15U1553">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U1037"><span class="var type1" id="S75T1U1556">unitA</span>(<span class="var type1" id="S99T15U1557">vap_end_ind</span>).*<span class="var type1" id="S98T17U1558">PowerFrac_Vaporize_over_NoVaporize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,445" id="srcline445">445</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,446" id="srcline446">446</a></span><span class="line">    <span class="mxinfo " id="T17:U1041"><span class="mxinfo " id="T17:U1042"><span class="var type1" id="S2T1U1562">P</span>(<span class="var type1" id="S99T15U1563">vap_end_ind</span>)</span> = <span class="var type1" id="S100T17U1564">P_init_to_postvap</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,447" id="srcline447">447</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,448" id="srcline448">448</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,449" id="srcline449">449</a></span><span class="line">    <span class="mxinfo " id="T5:U1046"><span class="autoExtrinsicFcn" id="F226N4:B1568">disp</span>(<span class="mxinfo " id="T22:U1047"><span class="string">'~~~~~~~~~~~~~~~~Maintain State~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,450" id="srcline450">450</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,451" id="srcline451">451</a></span><span class="line"><span class="comment">%     Hhi</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,452" id="srcline452">452</a></span><span class="line"><span class="comment">%     Hho</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,453" id="srcline453">453</a></span><span class="line"><span class="comment">%     Thi</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,454" id="srcline454">454</a></span><span class="line"><span class="comment">%     Tho</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,455" id="srcline455">455</a></span><span class="line"><span class="comment">%     Hci</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,456" id="srcline456">456</a></span><span class="line"><span class="comment">%     Hco</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,457" id="srcline457">457</a></span><span class="line"><span class="comment">%     Tci</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,458" id="srcline458">458</a></span><span class="line"><span class="comment">%     Tco</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,459" id="srcline459">459</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,460" id="srcline460">460</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,461" id="srcline461">461</a></span><span class="line"><span class="comment">% double check if hot fluid would condense and cool fluid would vaporize</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,462" id="srcline462">462</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U1048">any(<span class="mxinfo " id="T15:U1049">(<span class="mxinfo " id="T15:U1050"><span class="mxinfo " id="T15:U1051"><span class="var type1" id="S82T1U1578">Tho</span> &lt; <span class="var type1" id="S51T1U1579">Tvh</span></span> &amp; <span class="mxinfo " id="T15:U1054"><span class="var type1" id="S39T1U1581">Thi</span> &gt; <span class="var type1" id="S51T1U1582">Tvh</span></span></span>) &amp; (<span class="mxinfo " id="T15:U1057"><span class="mxinfo " id="T15:U1058"><span class="var type1" id="S83T1U1586">Tco</span> &gt; <span class="var type1" id="S52T1U1587">Tvc</span></span> &amp; <span class="mxinfo " id="T15:U1061"><span class="var type1" id="S40T1U1589">Tci</span> &lt; <span class="var type1" id="S52T1U1590">Tvc</span></span></span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,463" id="srcline463">463</a></span><span class="line">    error(<span class="string">'This function cannot accurately handle both fluids changing phase.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="28,464" id="srcline464">464</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,465" id="srcline465">465</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,466" id="srcline466">466</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U1064"><span class="var type1" id="S15T1U1598">A</span> &gt; <span class="var type1" id="S75T1U1599">unitA</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="28,467" id="srcline467">467</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,468" id="srcline468">468</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="28,469" id="srcline469">469</a></span><span class="line"><span class="comment">%     disp(['Power Before: ' num2str(P) ' W'])</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,470" id="srcline470">470</a></span><span class="line">    <span class="message error" id="M8F144C">[ <span class="var type0" id="S101T0U1603"><span class="message error" id="M9F144C">P_next</span></span>, <span class="var type0" id="S86T0U1604"><span class="message error" id="M10F144C">Hho</span></span>, <span class="var type0" id="S87T0U1605"><span class="message error" id="M11F144C">Hco</span></span> ] = HeatExNTU_3_low( <span class="var type1" id="S86T1U1608">Hho</span>, <span class="var type1" id="S6T1U1609">m_dot_h</span>, <span class="var type1" id="S7T1U1610">p_h</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,471" id="srcline471">471</a></span><span class="line">        <span class="var type1" id="S87T1U1611">Hco</span>, <span class="var type1" id="S9T1U1612">m_dot_c</span>, <span class="var type1" id="S10T1U1613">p_c</span>, <span class="var type1" id="S11T1U1614">fluid_h</span>, <span class="var type1" id="S12T1U1615">fluid_c</span>, <span class="var type1" id="S13T1U1616">HeatExType</span>, <span class="var type1" id="S14T1U1617">U</span>, <span class="mxinfo " id="T1:U1077"><span class="var type1" id="S15T1U1619">A</span> - <span class="var type1" id="S75T1U1620">unitA</span></span>, <span class="mxinfo " id="T12:U1080"><span class="string">'H'</span></span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,472" id="srcline472">472</a></span><span class="line"><span class="comment">%     A</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,473" id="srcline473">473</a></span><span class="line"><span class="comment">%     unitA</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,474" id="srcline474">474</a></span><span class="line"><span class="comment">% %     A - unitA;</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,475" id="srcline475">475</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,476" id="srcline476">476</a></span><span class="line">    <span class="var type0" id="S2T0U1624">P</span> = <span class="var type1" id="S2T1U1626">P</span> + <span class="var type0" id="S101T0U1627"><span class="message error" id="M12F144C">P_next</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,477" id="srcline477">477</a></span><span class="line"><span class="comment">%     disp(['Power After: ' num2str(P) ' W'])</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,478" id="srcline478">478</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,479" id="srcline479">479</a></span><span class="line">    <span class="mxinfo " id="T5:U1082"><span class="var type1" id="S88T5U1630">Hho_Ptr</span> = <span class="mxinfo " id="T5:U1084"><span class="extrinsicFcn" id="F227N8:B1632">libpointer</span>(<span class="mxinfo " id="T9:U1085"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S86T1U1634">Hho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,480" id="srcline480">480</a></span><span class="line">    <span class="mxinfo " id="T5:U1087"><span class="var type1" id="S89T5U1637">Hco_Ptr</span> = <span class="mxinfo " id="T5:U1089"><span class="extrinsicFcn" id="F228N8:B1639">libpointer</span>(<span class="mxinfo " id="T9:U1090"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S87T1U1641">Hco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,481" id="srcline481">481</a></span><span class="line"><span class="comment">% Update values located at Tho and Tco pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,482" id="srcline482">482</a></span><span class="line">    <span class="mxinfo " id="T5:U1092"><span class="extrinsicFcn" id="F229N3:B1644">calllib</span>(<span class="mxinfo " id="T6:U1093"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1094"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1647">handle_h</span>, <span class="var type1" id="S31T5U1648">hp_ind</span>, <span class="var type1" id="S88T5U1649">Hho_Ptr</span>, <span class="var type1" id="S35T5U1650">p_h_Ptr</span>, <span class="var type1" id="S24T1U1651">var_length</span>, <span class="var type1" id="S32T5U1652">t_ind</span>, <span class="var type1" id="S84T5U1653">Tho_Ptr</span>, <span class="var type1" id="S18T1U1654">ierr</span>,<span class="var type1" id="S20T3U1655">herr</span>,<span class="var type1" id="S17T1U1656">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,483" id="srcline483">483</a></span><span class="line">    <span class="mxinfo " id="T5:U1105"><span class="extrinsicFcn" id="F230N3:B1659">calllib</span>(<span class="mxinfo " id="T6:U1106"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1107"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1662">handle_c</span>, <span class="var type1" id="S31T5U1663">hp_ind</span>, <span class="var type1" id="S89T5U1664">Hco_Ptr</span>, <span class="var type1" id="S37T5U1665">p_c_Ptr</span>, <span class="var type1" id="S24T1U1666">var_length</span>, <span class="var type1" id="S32T5U1667">t_ind</span>, <span class="var type1" id="S85T5U1668">Tco_Ptr</span>, <span class="var type1" id="S18T1U1669">ierr</span>,<span class="var type1" id="S20T3U1670">herr</span>,<span class="var type1" id="S17T1U1671">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,484" id="srcline484">484</a></span><span class="line"><span class="comment">% Set Thi &amp; Tci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,485" id="srcline485">485</a></span><span class="line">    <span class="mxinfo " id="T1:U1118"><span class="var type1" id="S82T1U1674">Tho</span> = <span class="mxinfo " id="T5:U1120"><span class="extrinsicFcn" id="F231N7:B1676">get</span>(<span class="var type1" id="S84T5U1677">Tho_Ptr</span>,<span class="mxinfo " id="T13:U1122"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,486" id="srcline486">486</a></span><span class="line">    <span class="mxinfo " id="T1:U1123"><span class="var type1" id="S83T1U1681">Tco</span> = <span class="mxinfo " id="T5:U1125"><span class="extrinsicFcn" id="F232N7:B1683">get</span>(<span class="var type1" id="S85T5U1684">Tco_Ptr</span>,<span class="mxinfo " id="T13:U1127"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,487" id="srcline487">487</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,488" id="srcline488">488</a></span><span class="line"><span class="comment">% else</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,489" id="srcline489">489</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,490" id="srcline490">490</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,491" id="srcline491">491</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,492" id="srcline492">492</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,493" id="srcline493">493</a></span><span class="line"><span class="comment">% Free the hot and cool fluid handles</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,494" id="srcline494">494</a></span><span class="line"><span class="mxinfo " id="T5:U1128"><span class="extrinsicFcn" id="F233N3:B1688">calllib</span>(<span class="mxinfo " id="T6:U1129"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T23:U1130"><span class="string">'AbstractState_free'</span></span>, <span class="var type1" id="S26T5U1691">handle_h</span>, <span class="var type1" id="S18T1U1692">ierr</span>,<span class="var type1" id="S20T3U1693">herr</span>,<span class="var type1" id="S17T1U1694">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,495" id="srcline495">495</a></span><span class="line"><span class="mxinfo " id="T5:U1135"><span class="extrinsicFcn" id="F234N3:B1697">calllib</span>(<span class="mxinfo " id="T6:U1136"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T23:U1137"><span class="string">'AbstractState_free'</span></span>, <span class="var type1" id="S28T5U1700">handle_c</span>, <span class="var type1" id="S18T1U1701">ierr</span>,<span class="var type1" id="S20T3U1702">herr</span>,<span class="var type1" id="S17T1U1703">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,496" id="srcline496">496</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="28,497" id="srcline497">497</a></span><span class="line"><span class="keyword">if</span> upper(<span class="var type1" id="S16T12U1709">T_or_H</span>) == <span class="string">'T'</span> <span class="comment">%|| 'TEMPERATURE'</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,498" id="srcline498">498</a></span><span class="line">    <span class="var type0" id="S3T0U1713">T_or_H_ho</span> = <span class="var type0" id="S82T0U1714">Tho</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,499" id="srcline499">499</a></span><span class="line">    <span class="var type0" id="S4T0U1717">T_or_H_co</span> = <span class="var type0" id="S83T0U1718">Tco</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,500" id="srcline500">500</a></span><span class="line"><span class="keyword">elseif</span> upper(<span class="var type1" id="S16T12U1723">T_or_H</span>) == <span class="string">'H'</span> <span class="comment">%|| 'ENTHALPY'</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,501" id="srcline501">501</a></span><span class="line">    <span class="mxinfo " id="T1:U1144"><span class="var type1" id="S3T1U1727">T_or_H_ho</span> = <span class="var type1" id="S86T1U1728">Hho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,502" id="srcline502">502</a></span><span class="line">    <span class="mxinfo " id="T1:U1147"><span class="var type1" id="S4T1U1731">T_or_H_co</span> = <span class="var type1" id="S87T1U1732">Hco</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="28,503" id="srcline503">503</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,504" id="srcline504">504</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="28,505" id="srcline505">505</a></span><span class="line"></span></span>
</pre>
</body>
</html>
