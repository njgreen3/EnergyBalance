<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">P</span>, <span class="var type1" id="S3T1U4">T_or_H_ho</span>, <span class="var type1" id="S4T1U5">T_or_H_co</span> ] = HeatExNTU_3_low( <span class="var type1" id="S5T1U8">T_or_H_hi</span>, <span class="var type1" id="S6T1U9">m_dot_h</span>, <span class="var type1" id="S7T1U10">p_h</span>,  <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">    <span class="var type1" id="S8T1U11">T_or_H_ci</span>, <span class="var type1" id="S9T1U12">m_dot_c</span>, <span class="var type1" id="S10T1U13">p_c</span>, <span class="var type2" id="S11T1V1U14">fluid_c</span>, <span class="var type1" id="S12T1U15">HeatExType</span>, <span class="var type1" id="S13T1U16">U</span>, <span class="var type1" id="S14T1U17">A</span>, <span class="var type1" id="S15T1U18">T_or_H</span>,  <span class="var type2" id="S16T1V1U19">fluid_h</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%HeatExNTU Summary </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   This function calculates flow and outlet temperatures of a heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   using the Number of Transfer Units (NTU) method as described in</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   Fundementals of Heat and Mass Transfer by F. P. Incropera, D. P.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   DeWitt, T. L. Bergman &amp; A. S. Lavine. The method can be used when only</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   the inlet tempertures are known as opposed to inlet and outlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   temperatures.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   This is done by calculating effectiveness which is defined as the ratio</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   of actual heat transferred to the maximum possible heat transferred for </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   an infinite length counter-flow heat exchanger with the given inlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%   temperatures. The effectivenes is calculated differently depending on </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%   the geometry of exchanger but is always a function of the ratio of heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%   capacity rates as well as the number of transfer units (NTU). The NTU</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%   depends on the overall heat transfer coefficient, the heat transfer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%   area, and the smaller of the two heat capacity rates. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%   In the event of a phase change the rate of change of energy required to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%   get the fluid just beyond the point of vaporizaion or condensation is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%   calculated using the CoolProp function. Then the function is called</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%   again at the new temperature and the final temperatures and heat rates</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%   are calucluated using a reduced heat exhange area. I currently assume</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%   the effected heat transfer area is a half of the original input. This </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%   function cannot accurately handle both fluids changing phase because it</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%   does not check which fluid would change first.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% Note: The effectiveness is separte from efficiency. The calculations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%   assumes an efficiency of 1 where all heat is transferred from the hot</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%   fluid to the cool fluid or remains within the the fluid. This also</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%   assumes no fluid is undergoing a change in state, which may not be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">%   sufficient for my final model.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% This function makes use of CoolProp, a shared DLL. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">% More information about the Matlab wrapper can be found at</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/coolprop/wrappers/MATLAB/index.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% A list of parameters can be found at </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/coolprop/HighLevelAPI.html#parameter-table</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">% A list of fluids can be found at </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">%   http://www.coolprop.org/fluid_properties/PurePseudoPure.html#list-of-fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">%   T_or_H_hi   Hot fluid inlet temperature in Kelvin or enthalpy in J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%   m_dot_h     Hot fluid mass flow rate in kg/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">%   p_h         Hot fluid pressure in pa</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%   fluid_h     Name of Hot fluid (string)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">%   T_or_H_ci   Cool fluid inlet temperature in Kelvin or enthalpy in J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="comment">%   m_dot_c     Cool fluid mass flow rate in kg/s</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">%   p_c         Cool fluid pressure in pa</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="comment">%   fluid_c     Name of Cool fluid (string)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="comment">%   HeatExType  String describing the heat exchanger geometry. Currently</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="comment">%               this variable only accepts 'counter' and 'parallel', but</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="comment">%               can be expanded to other exchanger/flow types</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%               'counter' for counter flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%               'parallel' for parallel</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%   U           Overall heat transfer coefficient in W/(K m2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="comment">%   A           Heat transfer area in m2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">%   T_or_H      String stating whether arguements 1&amp;5 are temperature (T) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%               or enthaply (H). Also applies to output</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="comment">% Output:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%   P           Rate of heat exchenged (power) in W</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%   T_or_H_ho   Hot fluid outlet temperature (K) or enthalpy J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="comment">%   T_or_H_co   Cool fluid outlet temperature (K) or enthalpy J/kg</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="comment">% initailize certain parameters used to call coolprop library</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo " id="T1:U16"><span class="var type1" id="S17T1U22">buffer_size</span> = <span class="mxinfo " id="T1:U18">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T1:U19"><span class="var type1" id="S18T1U26">ierr</span> = <span class="mxinfo " id="T1:U21">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo " id="T2:U22"><span class="var type1" id="S19T2U30">b</span> = (<span class="mxinfo " id="T2:U24">1:1:<span class="var type1" id="S17T1U36">buffer_size</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T3:U26"><span class="var type1" id="S20T3U39">herr</span>= <span class="mxinfo " id="T3:U28">char(<span class="var type1" id="S19T2U42">b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T4:U30"><span class="var type1" id="S22T4U45">backend</span> = <span class="mxinfo " id="T4:U32"><span class="string">'HEOS'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">coder.extrinsic(<span class="string">'calllib'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">coder.extrinsic(<span class="string">'libpointer'</span>) </span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% All the input signals should be the same size, so it shouldn't matter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% which one is used to obtain signal length</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S24T1U61">var_length</span> = <span class="mxinfo " id="T1:U35">length(<span class="var type1" id="S5T1U64">T_or_H_hi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">% initialize handles for hot and cool fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">[<span class="var type1" id="S26T5U68">handle_h</span>, <span class="mxinfo " id="T5:U38">~</span>] = <span class="extrinsicFcn" id="F20N3:B71">calllib</span>(<span class="mxinfo " id="T6:U39"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T7:U40"><span class="string">'AbstractState_factory'</span></span>,<span class="var type1" id="S22T4U74">backend</span>,<span class="var type1" id="S16T1U75">fluid_h</span>,<span class="var type1" id="S18T1U76">ierr</span>,<span class="var type1" id="S20T3U77">herr</span>,<span class="var type1" id="S17T1U78">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">[<span class="var type1" id="S28T5U82">handle_c</span>, <span class="mxinfo " id="T5:U47">~</span>] = <span class="extrinsicFcn" id="F21N3:B85">calllib</span>(<span class="mxinfo " id="T6:U48"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T7:U49"><span class="string">'AbstractState_factory'</span></span>,<span class="var type1" id="S22T4U88">backend</span>,<span class="var type1" id="S11T1U89">fluid_c</span>,<span class="var type1" id="S18T1U90">ierr</span>,<span class="var type1" id="S20T3U91">herr</span>,<span class="var type1" id="S17T1U92">buffer_size</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">% determine input parameter pair indecies for coolprop calls</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">[<span class="var type1" id="S29T5U96">pq_ind</span>,<span class="mxinfo " id="T5:U56">~</span>] = <span class="extrinsicFcn" id="F22N3:B99">calllib</span>(<span class="mxinfo " id="T6:U57"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U58"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T9:U59"><span class="string">'PQ_INPUTS'</span></span>); <span class="comment">%pressure and Mass vapor quality</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">[<span class="var type1" id="S30T5U106">pt_ind</span>,<span class="mxinfo " id="T5:U61">~</span>] = <span class="extrinsicFcn" id="F23N3:B109">calllib</span>(<span class="mxinfo " id="T6:U62"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U63"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T9:U64"><span class="string">'PT_INPUTS'</span></span>); <span class="comment">%pressure and temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">[<span class="var type1" id="S31T5U116">hp_ind</span>,<span class="mxinfo " id="T5:U66">~</span>] = <span class="extrinsicFcn" id="F24N3:B119">calllib</span>(<span class="mxinfo " id="T6:U67"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T8:U68"><span class="string">'get_input_pair_index'</span></span>,<span class="mxinfo " id="T10:U69"><span class="string">'HmassP_INPUTS'</span></span>); <span class="comment">%Mass specific enthalpy and pressure</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">% determine output parameter indecies for coolprop calls</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">[<span class="var type1" id="S32T5U126">t_ind</span>, <span class="mxinfo " id="T5:U71">~</span>] = <span class="extrinsicFcn" id="F25N3:B129">calllib</span>(<span class="mxinfo " id="T6:U72"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U73"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T12:U74"><span class="string">'T'</span></span>); <span class="comment">%temperature</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">[<span class="var type1" id="S33T5U136">h_ind</span>, <span class="mxinfo " id="T5:U76">~</span>] = <span class="extrinsicFcn" id="F26N3:B139">calllib</span>(<span class="mxinfo " id="T6:U77"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U78"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T13:U79"><span class="string">'Hmass'</span></span>); <span class="comment">%Mass specific enthalpy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">[<span class="var type1" id="S34T5U146">c_ind</span>, <span class="mxinfo " id="T5:U81">~</span>] = <span class="extrinsicFcn" id="F27N3:B149">calllib</span>(<span class="mxinfo " id="T6:U82"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T11:U83"><span class="string">'get_param_index'</span></span>,<span class="mxinfo " id="T14:U84"><span class="string">'Cpmass'</span></span>); <span class="comment">%Mass specific constant pressure specific heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"><span class="comment">% find pointer location of pressure and temperature input values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo " id="T5:U85"><span class="var type1" id="S35T5U155">p_h_Ptr</span> = <span class="mxinfo " id="T5:U87"><span class="extrinsicFcn" id="F28N8:B157">libpointer</span>(<span class="mxinfo " id="T9:U88"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S7T1U159">p_h</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T5:U90"><span class="var type1" id="S37T5U162">p_c_Ptr</span> = <span class="mxinfo " id="T5:U92"><span class="extrinsicFcn" id="F29N8:B164">libpointer</span>(<span class="mxinfo " id="T9:U93"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S10T1U166">p_c</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="comment">% Thi_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="comment">% Tci_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">% Hhi_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="comment">% Hci_Ptr</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">% Ensure temperature/enthalpy input variables are delt with appropriately</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="comment">% if upper(T_or_H) == 'T' %|| 'TEMPERATURE'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U95"><span class="var type1" id="S15T1U170">T_or_H</span> == <span class="mxinfo " id="T12:U97"><span class="string">'T'</span></span></span> <span class="comment">%|| 'TEMPERATURE'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"><span class="comment">% Assume given temperature values are not at vaporization/condensation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line"><span class="comment">% Initialize T and H values </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T1:U98"><span class="var type1" id="S38T1U174">Thi</span> = <span class="var type1" id="S5T1U175">T_or_H_hi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T1:U101"><span class="var type1" id="S39T1U178">Tci</span> = <span class="var type1" id="S8T1U179">T_or_H_ci</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo " id="T5:U104"><span class="var type1" id="S40T5U182">Thi_Ptr</span> = <span class="mxinfo " id="T5:U106"><span class="extrinsicFcn" id="F30N8:B184">libpointer</span>(<span class="mxinfo " id="T9:U107"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S38T1U186">Thi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="mxinfo " id="T5:U109"><span class="var type1" id="S41T5U189">Tci_Ptr</span> = <span class="mxinfo " id="T5:U111"><span class="extrinsicFcn" id="F31N8:B191">libpointer</span>(<span class="mxinfo " id="T9:U112"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S39T1U193">Tci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    <span class="mxinfo " id="T1:U114"><span class="var type1" id="S42T1U196">Hhi</span> = <span class="mxinfo " id="T1:U116">zeros(<span class="var type1" id="S24T1U199">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="mxinfo " id="T1:U118"><span class="var type1" id="S44T1U203">Hci</span> = <span class="mxinfo " id="T1:U120">zeros(<span class="var type1" id="S24T1U206">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">    <span class="mxinfo " id="T5:U122"><span class="var type1" id="S45T5U210">Hhi_Ptr</span> = <span class="mxinfo " id="T5:U124"><span class="extrinsicFcn" id="F32N8:B212">libpointer</span>(<span class="mxinfo " id="T9:U125"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S42T1U214">Hhi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="mxinfo " id="T5:U127"><span class="var type1" id="S46T5U217">Hci_Ptr</span> = <span class="mxinfo " id="T5:U129"><span class="extrinsicFcn" id="F33N8:B219">libpointer</span>(<span class="mxinfo " id="T9:U130"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S44T1U221">Hci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="comment">% Update values located at Hhi and Hci pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    <span class="mxinfo " id="T5:U132"><span class="extrinsicFcn" id="F34N3:B224">calllib</span>(<span class="mxinfo " id="T6:U133"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U134"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U227">handle_h</span>, <span class="var type1" id="S30T5U228">pt_ind</span>, <span class="var type1" id="S35T5U229">p_h_Ptr</span>, <span class="var type1" id="S40T5U230">Thi_Ptr</span>, <span class="var type1" id="S24T1U231">var_length</span>, <span class="var type1" id="S33T5U232">h_ind</span>, <span class="var type1" id="S45T5U233">Hhi_Ptr</span>, <span class="var type1" id="S18T1U234">ierr</span>,<span class="var type1" id="S20T3U235">herr</span>,<span class="var type1" id="S17T1U236">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    <span class="mxinfo " id="T5:U145"><span class="extrinsicFcn" id="F35N3:B239">calllib</span>(<span class="mxinfo " id="T6:U146"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U147"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U242">handle_c</span>, <span class="var type1" id="S30T5U243">pt_ind</span>, <span class="var type1" id="S37T5U244">p_c_Ptr</span>, <span class="var type1" id="S41T5U245">Tci_Ptr</span>, <span class="var type1" id="S24T1U246">var_length</span>, <span class="var type1" id="S33T5U247">h_ind</span>, <span class="var type1" id="S46T5U248">Hci_Ptr</span>, <span class="var type1" id="S18T1U249">ierr</span>,<span class="var type1" id="S20T3U250">herr</span>,<span class="var type1" id="S17T1U251">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line"><span class="comment">% Set Hhi &amp; Hci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="mxinfo " id="T1:U158"><span class="var type1" id="S42T1U254">Hhi</span> = <span class="mxinfo " id="T5:U160"><span class="extrinsicFcn" id="F36N7:B256">get</span>(<span class="var type1" id="S45T5U257">Hhi_Ptr</span>,<span class="mxinfo " id="T13:U162"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">    <span class="mxinfo " id="T1:U163"><span class="var type1" id="S44T1U261">Hci</span> = <span class="mxinfo " id="T5:U165"><span class="extrinsicFcn" id="F37N7:B263">get</span>(<span class="var type1" id="S46T5U264">Hci_Ptr</span>,<span class="mxinfo " id="T13:U167"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"><span class="comment">% elseif upper(T_or_H) == 'H' %|| 'ENTHALPY'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U168"><span class="var type1" id="S15T1U268">T_or_H</span> == <span class="mxinfo " id="T12:U170"><span class="string">'H'</span></span></span> <span class="comment">%|| 'ENTHALPY'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="comment">% Enthalpy values can be in vaporization/condensation region    </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line"><span class="comment">% Initialize H and T values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo " id="T1:U171"><span class="var type1" id="S42T1U272">Hhi</span> = <span class="var type1" id="S5T1U273">T_or_H_hi</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo " id="T1:U174"><span class="var type1" id="S44T1U276">Hci</span> = <span class="var type1" id="S8T1U277">T_or_H_ci</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="mxinfo " id="T5:U177"><span class="var type1" id="S45T5U280">Hhi_Ptr</span> = <span class="mxinfo " id="T5:U179"><span class="extrinsicFcn" id="F38N8:B282">libpointer</span>(<span class="mxinfo " id="T9:U180"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S42T1U284">Hhi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T5:U182"><span class="var type1" id="S46T5U287">Hci_Ptr</span> = <span class="mxinfo " id="T5:U184"><span class="extrinsicFcn" id="F39N8:B289">libpointer</span>(<span class="mxinfo " id="T9:U185"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S44T1U291">Hci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T1:U187"><span class="var type1" id="S38T1U294">Thi</span> = <span class="mxinfo " id="T1:U189">zeros(<span class="var type1" id="S24T1U297">var_length</span>,1)</span></span>; <span class="comment">%initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T1:U191"><span class="var type1" id="S39T1U301">Tci</span> = <span class="mxinfo " id="T1:U193">zeros(<span class="var type1" id="S24T1U304">var_length</span>,1)</span></span>; <span class="comment">%initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="mxinfo " id="T5:U195"><span class="var type1" id="S40T5U308">Thi_Ptr</span> = <span class="mxinfo " id="T5:U197"><span class="extrinsicFcn" id="F40N8:B310">libpointer</span>(<span class="mxinfo " id="T9:U198"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S38T1U312">Thi</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo " id="T5:U200"><span class="var type1" id="S41T5U315">Tci_Ptr</span> = <span class="mxinfo " id="T5:U202"><span class="extrinsicFcn" id="F41N8:B317">libpointer</span>(<span class="mxinfo " id="T9:U203"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S39T1U319">Tci</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="comment">% Update values located at Thi and Tci pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo " id="T5:U205"><span class="extrinsicFcn" id="F42N3:B322">calllib</span>(<span class="mxinfo " id="T6:U206"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U207"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U325">handle_h</span>, <span class="var type1" id="S31T5U326">hp_ind</span>, <span class="var type1" id="S45T5U327">Hhi_Ptr</span>, <span class="var type1" id="S35T5U328">p_h_Ptr</span>, <span class="var type1" id="S24T1U329">var_length</span>, <span class="var type1" id="S32T5U330">t_ind</span>, <span class="var type1" id="S40T5U331">Thi_Ptr</span>, <span class="var type1" id="S18T1U332">ierr</span>,<span class="var type1" id="S20T3U333">herr</span>,<span class="var type1" id="S17T1U334">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T5:U218"><span class="extrinsicFcn" id="F43N3:B337">calllib</span>(<span class="mxinfo " id="T6:U219"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U220"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U340">handle_c</span>, <span class="var type1" id="S31T5U341">hp_ind</span>, <span class="var type1" id="S46T5U342">Hci_Ptr</span>, <span class="var type1" id="S37T5U343">p_c_Ptr</span>, <span class="var type1" id="S24T1U344">var_length</span>, <span class="var type1" id="S32T5U345">t_ind</span>, <span class="var type1" id="S41T5U346">Tci_Ptr</span>, <span class="var type1" id="S18T1U347">ierr</span>,<span class="var type1" id="S20T3U348">herr</span>,<span class="var type1" id="S17T1U349">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="comment">% Set Thi &amp; Tci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo " id="T1:U231"><span class="var type1" id="S38T1U352">Thi</span> = <span class="mxinfo " id="T5:U233"><span class="extrinsicFcn" id="F44N7:B354">get</span>(<span class="var type1" id="S40T5U355">Thi_Ptr</span>,<span class="mxinfo " id="T13:U235"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="mxinfo " id="T1:U236"><span class="var type1" id="S39T1U359">Tci</span> = <span class="mxinfo " id="T5:U238"><span class="extrinsicFcn" id="F45N7:B361">get</span>(<span class="var type1" id="S41T5U362">Tci_Ptr</span>,<span class="mxinfo " id="T13:U240"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    error(<span class="string">'Please specify whether input uses variables of Temperature or Enthalpy.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line"><span class="comment">% Determine vaporization temperature for fluids at respective pressures.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line"><span class="comment">% Initialize pointer locations for relevant variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="mxinfo " id="T5:U241"><span class="var type1" id="S49T5U371">Q_Ptr</span> = <span class="mxinfo " id="T5:U243"><span class="extrinsicFcn" id="F48N8:B373">libpointer</span>(<span class="mxinfo " id="T9:U244"><span class="string">'doublePtr'</span></span>, <span class="mxinfo " id="T1:U245">zeros(<span class="var type1" id="S24T1U377">var_length</span>,1)</span>)</span></span>; <span class="comment">% Q is specifically set to 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"><span class="mxinfo " id="T1:U247"><span class="var type1" id="S50T1U381">Tvh</span> = <span class="mxinfo " id="T1:U249">zeros(<span class="var type1" id="S24T1U384">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"><span class="mxinfo " id="T1:U251"><span class="var type1" id="S51T1U388">Tvc</span> = <span class="mxinfo " id="T1:U253">zeros(<span class="var type1" id="S24T1U391">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="mxinfo " id="T5:U255"><span class="var type1" id="S52T5U395">Tvh_Ptr</span> = <span class="mxinfo " id="T5:U257"><span class="extrinsicFcn" id="F49N8:B397">libpointer</span>(<span class="mxinfo " id="T9:U258"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S50T1U399">Tvh</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="mxinfo " id="T5:U260"><span class="var type1" id="S53T5U402">Tvc_Ptr</span> = <span class="mxinfo " id="T5:U262"><span class="extrinsicFcn" id="F50N8:B404">libpointer</span>(<span class="mxinfo " id="T9:U263"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S51T1U406">Tvc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="comment">% Update values located at the Tvc &amp; Tvh pointer locations for vaporization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="comment">% conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T5:U265"><span class="extrinsicFcn" id="F51N3:B409">calllib</span>(<span class="mxinfo " id="T6:U266"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U267"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U412">handle_h</span>, <span class="var type1" id="S29T5U413">pq_ind</span>, <span class="var type1" id="S35T5U414">p_h_Ptr</span>, <span class="var type1" id="S49T5U415">Q_Ptr</span>, <span class="var type1" id="S24T1U416">var_length</span>, <span class="var type1" id="S32T5U417">t_ind</span>, <span class="var type1" id="S52T5U418">Tvh_Ptr</span>, <span class="var type1" id="S18T1U419">ierr</span>,<span class="var type1" id="S20T3U420">herr</span>,<span class="var type1" id="S17T1U421">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T5:U278"><span class="extrinsicFcn" id="F52N3:B424">calllib</span>(<span class="mxinfo " id="T6:U279"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U280"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U427">handle_c</span>, <span class="var type1" id="S29T5U428">pq_ind</span>, <span class="var type1" id="S37T5U429">p_c_Ptr</span>, <span class="var type1" id="S49T5U430">Q_Ptr</span>, <span class="var type1" id="S24T1U431">var_length</span>, <span class="var type1" id="S32T5U432">t_ind</span>, <span class="var type1" id="S53T5U433">Tvc_Ptr</span>, <span class="var type1" id="S18T1U434">ierr</span>,<span class="var type1" id="S20T3U435">herr</span>,<span class="var type1" id="S17T1U436">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="comment">% Set Tvh &amp; Tvc to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="mxinfo " id="T1:U291"><span class="var type1" id="S50T1U439">Tvh</span> = <span class="mxinfo " id="T5:U293"><span class="extrinsicFcn" id="F53N7:B441">get</span>(<span class="var type1" id="S52T5U442">Tvh_Ptr</span>,<span class="mxinfo " id="T13:U295"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo " id="T1:U296"><span class="var type1" id="S51T1U446">Tvc</span> = <span class="mxinfo " id="T5:U298"><span class="extrinsicFcn" id="F54N7:B448">get</span>(<span class="var type1" id="S53T5U449">Tvc_Ptr</span>,<span class="mxinfo " id="T13:U300"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"><span class="comment">% Determine vaporization enthalpies for fluids at respective pressures</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="comment">% Min enthalpies of vaporization region for hot and cool fluids (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="mxinfo " id="T1:U301"><span class="var type1" id="S54T1U453">Hvh_min</span> = <span class="mxinfo " id="T1:U303">zeros(<span class="var type1" id="S24T1U456">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo " id="T1:U305"><span class="var type1" id="S55T1U460">Hvc_min</span> = <span class="mxinfo " id="T1:U307">zeros(<span class="var type1" id="S24T1U463">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo " id="T5:U309"><span class="var type1" id="S56T5U467">Hvh_min_Ptr</span> = <span class="mxinfo " id="T5:U311"><span class="extrinsicFcn" id="F55N8:B469">libpointer</span>(<span class="mxinfo " id="T9:U312"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S54T1U471">Hvh_min</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo " id="T5:U314"><span class="var type1" id="S57T5U474">Hvc_min_Ptr</span> = <span class="mxinfo " id="T5:U316"><span class="extrinsicFcn" id="F56N8:B476">libpointer</span>(<span class="mxinfo " id="T9:U317"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S55T1U478">Hvc_min</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="comment">% Update values located at Hvh_max and Hvc_max pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="mxinfo " id="T5:U319"><span class="extrinsicFcn" id="F57N3:B481">calllib</span>(<span class="mxinfo " id="T6:U320"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U321"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U484">handle_h</span>, <span class="var type1" id="S29T5U485">pq_ind</span>, <span class="var type1" id="S35T5U486">p_h_Ptr</span>, <span class="var type1" id="S49T5U487">Q_Ptr</span>, <span class="var type1" id="S24T1U488">var_length</span>, <span class="var type1" id="S33T5U489">h_ind</span>, <span class="var type1" id="S56T5U490">Hvh_min_Ptr</span>, <span class="var type1" id="S18T1U491">ierr</span>,<span class="var type1" id="S20T3U492">herr</span>,<span class="var type1" id="S17T1U493">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo " id="T5:U332"><span class="extrinsicFcn" id="F58N3:B496">calllib</span>(<span class="mxinfo " id="T6:U333"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U334"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U499">handle_c</span>, <span class="var type1" id="S29T5U500">pq_ind</span>, <span class="var type1" id="S37T5U501">p_c_Ptr</span>, <span class="var type1" id="S49T5U502">Q_Ptr</span>, <span class="var type1" id="S24T1U503">var_length</span>, <span class="var type1" id="S33T5U504">h_ind</span>, <span class="var type1" id="S57T5U505">Hvc_min_Ptr</span>, <span class="var type1" id="S18T1U506">ierr</span>,<span class="var type1" id="S20T3U507">herr</span>,<span class="var type1" id="S17T1U508">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="comment">% Set Hvh_max &amp; Hvc_max to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="mxinfo " id="T1:U345"><span class="var type1" id="S54T1U511">Hvh_min</span> = <span class="mxinfo " id="T5:U347"><span class="extrinsicFcn" id="F59N7:B513">get</span>(<span class="var type1" id="S56T5U514">Hvh_min_Ptr</span>,<span class="mxinfo " id="T13:U349"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="mxinfo " id="T1:U350"><span class="var type1" id="S55T1U518">Hvc_min</span> = <span class="mxinfo " id="T5:U352"><span class="extrinsicFcn" id="F60N7:B520">get</span>(<span class="var type1" id="S57T5U521">Hvc_min_Ptr</span>,<span class="mxinfo " id="T13:U354"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="comment">% Max enthalpies of vaporization region for hot and cool fluid (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="mxinfo " id="T5:U355"><span class="var type1" id="S49T5U525">Q_Ptr</span> = <span class="mxinfo " id="T5:U357"><span class="extrinsicFcn" id="F61N8:B527">libpointer</span>(<span class="mxinfo " id="T9:U358"><span class="string">'doublePtr'</span></span>, <span class="mxinfo " id="T1:U359">ones(<span class="var type1" id="S24T1U531">var_length</span>,1)</span>)</span></span>; <span class="comment">% Q is specifically set to 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo " id="T1:U361"><span class="var type1" id="S59T1U535">Hvh_max</span> = <span class="mxinfo " id="T1:U363">zeros(<span class="var type1" id="S24T1U538">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo " id="T1:U365"><span class="var type1" id="S60T1U542">Hvc_max</span> = <span class="mxinfo " id="T1:U367">zeros(<span class="var type1" id="S24T1U545">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo " id="T5:U369"><span class="var type1" id="S61T5U549">Hvh_max_Ptr</span> = <span class="mxinfo " id="T5:U371"><span class="extrinsicFcn" id="F62N8:B551">libpointer</span>(<span class="mxinfo " id="T9:U372"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S59T1U553">Hvh_max</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo " id="T5:U374"><span class="var type1" id="S62T5U556">Hvc_max_Ptr</span> = <span class="mxinfo " id="T5:U376"><span class="extrinsicFcn" id="F63N8:B558">libpointer</span>(<span class="mxinfo " id="T9:U377"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S60T1U560">Hvc_max</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="comment">% Update values located at Hvh_max and Hvc_max pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo " id="T5:U379"><span class="extrinsicFcn" id="F64N3:B563">calllib</span>(<span class="mxinfo " id="T6:U380"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U381"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U566">handle_h</span>, <span class="var type1" id="S29T5U567">pq_ind</span>, <span class="var type1" id="S35T5U568">p_h_Ptr</span>, <span class="var type1" id="S49T5U569">Q_Ptr</span>, <span class="var type1" id="S24T1U570">var_length</span>, <span class="var type1" id="S33T5U571">h_ind</span>, <span class="var type1" id="S61T5U572">Hvh_max_Ptr</span>, <span class="var type1" id="S18T1U573">ierr</span>,<span class="var type1" id="S20T3U574">herr</span>,<span class="var type1" id="S17T1U575">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo " id="T5:U392"><span class="extrinsicFcn" id="F65N3:B578">calllib</span>(<span class="mxinfo " id="T6:U393"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U394"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U581">handle_c</span>, <span class="var type1" id="S29T5U582">pq_ind</span>, <span class="var type1" id="S37T5U583">p_c_Ptr</span>, <span class="var type1" id="S49T5U584">Q_Ptr</span>, <span class="var type1" id="S24T1U585">var_length</span>, <span class="var type1" id="S33T5U586">h_ind</span>, <span class="var type1" id="S62T5U587">Hvc_max_Ptr</span>, <span class="var type1" id="S18T1U588">ierr</span>,<span class="var type1" id="S20T3U589">herr</span>,<span class="var type1" id="S17T1U590">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="comment">% Set Hvh_max &amp; Hvc_max to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo " id="T1:U405"><span class="var type1" id="S59T1U593">Hvh_max</span> = <span class="mxinfo " id="T5:U407"><span class="extrinsicFcn" id="F66N7:B595">get</span>(<span class="var type1" id="S61T5U596">Hvh_max_Ptr</span>,<span class="mxinfo " id="T13:U409"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line"><span class="mxinfo " id="T1:U410"><span class="var type1" id="S60T1U600">Hvc_max</span> = <span class="mxinfo " id="T5:U412"><span class="extrinsicFcn" id="F67N7:B602">get</span>(<span class="var type1" id="S62T5U603">Hvc_max_Ptr</span>,<span class="mxinfo " id="T13:U414"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line"><span class="comment">% Determine the specific heats of the incoming fluids using coolprop</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line"><span class="comment">% Initialize pointer locations for relevant variables</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line"><span class="mxinfo " id="T1:U415"><span class="var type1" id="S63T1U607">Ch</span> = <span class="mxinfo " id="T1:U417">zeros(<span class="var type1" id="S24T1U610">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo " id="T1:U419"><span class="var type1" id="S64T1U614">Cc</span> = <span class="mxinfo " id="T1:U421">zeros(<span class="var type1" id="S24T1U617">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line"><span class="mxinfo " id="T5:U423"><span class="var type1" id="S65T5U621">Ch_Ptr</span> = <span class="mxinfo " id="T5:U425"><span class="extrinsicFcn" id="F68N8:B623">libpointer</span>(<span class="mxinfo " id="T9:U426"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S63T1U625">Ch</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line"><span class="mxinfo " id="T5:U428"><span class="var type1" id="S66T5U628">Cc_Ptr</span> = <span class="mxinfo " id="T5:U430"><span class="extrinsicFcn" id="F69N8:B630">libpointer</span>(<span class="mxinfo " id="T9:U431"><span class="string">'doublePtr'</span></span>, <span class="var type1" id="S64T1U632">Cc</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line"><span class="comment">% Update values located at the Ch &amp; Cc pointer locations for input</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line"><span class="comment">% conditions</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line"><span class="mxinfo " id="T5:U433"><span class="extrinsicFcn" id="F70N3:B635">calllib</span>(<span class="mxinfo " id="T6:U434"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U435"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U638">handle_h</span>, <span class="var type1" id="S30T5U639">pt_ind</span>, <span class="var type1" id="S35T5U640">p_h_Ptr</span>, <span class="var type1" id="S40T5U641">Thi_Ptr</span>, <span class="var type1" id="S24T1U642">var_length</span>, <span class="var type1" id="S34T5U643">c_ind</span>, <span class="var type1" id="S65T5U644">Ch_Ptr</span>, <span class="var type1" id="S18T1U645">ierr</span>,<span class="var type1" id="S20T3U646">herr</span>,<span class="var type1" id="S17T1U647">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line"><span class="mxinfo " id="T5:U446"><span class="extrinsicFcn" id="F71N3:B650">calllib</span>(<span class="mxinfo " id="T6:U447"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U448"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U653">handle_c</span>, <span class="var type1" id="S30T5U654">pt_ind</span>, <span class="var type1" id="S37T5U655">p_c_Ptr</span>, <span class="var type1" id="S41T5U656">Tci_Ptr</span>, <span class="var type1" id="S24T1U657">var_length</span>, <span class="var type1" id="S34T5U658">c_ind</span>, <span class="var type1" id="S66T5U659">Cc_Ptr</span>, <span class="var type1" id="S18T1U660">ierr</span>,<span class="var type1" id="S20T3U661">herr</span>,<span class="var type1" id="S17T1U662">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line"><span class="comment">% Set Ch &amp; Cc to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="mxinfo " id="T1:U459"><span class="var type1" id="S63T1U665">Ch</span> = <span class="mxinfo " id="T5:U461"><span class="extrinsicFcn" id="F72N7:B667">get</span>(<span class="var type1" id="S65T5U668">Ch_Ptr</span>,<span class="mxinfo " id="T13:U463"><span class="string">'Value'</span></span>)</span></span>;   <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"><span class="mxinfo " id="T1:U464"><span class="var type1" id="S64T1U672">Cc</span> = <span class="mxinfo " id="T5:U466"><span class="extrinsicFcn" id="F73N7:B674">get</span>(<span class="var type1" id="S66T5U675">Cc_Ptr</span>,<span class="mxinfo " id="T13:U468"><span class="string">'Value'</span></span>)</span></span>;   <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line"><span class="comment">% If the fluid is withing 1e-4 units of the vaporization point then the </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line"><span class="comment">% will return an inaccurate values. If that happens then the specific heat </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line"><span class="comment">% will be set to inf so its temperature will not change even though heat is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line"><span class="comment">% exchanged.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line"><span class="mxinfo " id="T17:U469"><span class="mxinfo " id="T17:U470"><span class="var type1" id="S63T1U680">Ch</span>(<span class="mxinfo " id="T15:U472"><span class="mxinfo " id="T1:U473">abs(<span class="mxinfo " id="T1:U474"><span class="var type1" id="S38T1U685">Thi</span> - <span class="var type1" id="S50T1U686">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U477">1e-4</span></span>)</span> = <span class="mxinfo " id="T1:U478">inf</span></span>;    <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line"><span class="mxinfo " id="T17:U479"><span class="mxinfo " id="T17:U480"><span class="var type1" id="S64T1U693">Cc</span>(<span class="mxinfo " id="T15:U482"><span class="mxinfo " id="T1:U483">abs(<span class="mxinfo " id="T1:U484"><span class="var type1" id="S39T1U698">Tci</span> - <span class="var type1" id="S51T1U699">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U487">1e-4</span></span>)</span> = <span class="mxinfo " id="T1:U488">inf</span></span>;    <span class="comment">% J/(kg K)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line"><span class="comment">% Calculate the heat capacity rates of the hot and cool fluids</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line"><span class="mxinfo " id="T1:U489"><span class="var type1" id="S69T1U705">Ch_rate</span> = <span class="mxinfo " id="T1:U491"><span class="var type1" id="S63T1U707">Ch</span> .* <span class="var type1" id="S6T1U708">m_dot_h</span></span></span>;     <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line"><span class="mxinfo " id="T1:U494"><span class="var type1" id="S70T1U711">Cc_rate</span> = <span class="mxinfo " id="T1:U496"><span class="var type1" id="S64T1U713">Cc</span> .* <span class="var type1" id="S9T1U714">m_dot_c</span></span></span>;     <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"><span class="comment">% Determine the maximum and minimum of the two heat capacity rates</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="mxinfo " id="T1:U499"><span class="var type1" id="S71T1U717">Cmax</span> = <span class="var type1" id="S69T1U718">Ch_rate</span></span>; <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"><span class="mxinfo " id="T17:U502"><span class="mxinfo " id="T17:U503"><span class="var type1" id="S71T1U722">Cmax</span>(<span class="mxinfo " id="T15:U505"><span class="var type1" id="S69T1U724">Ch_rate</span> &lt; <span class="var type1" id="S70T1U725">Cc_rate</span></span>)</span> = <span class="var type1" id="S70T1U727">Cc_rate</span>(<span class="mxinfo " id="T15:U509"><span class="var type1" id="S69T1U729">Ch_rate</span> &lt; <span class="var type1" id="S70T1U730">Cc_rate</span></span>)</span>;   <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line"><span class="mxinfo " id="T1:U512"><span class="var type1" id="S72T1U733">Cmin</span> = <span class="var type1" id="S69T1U734">Ch_rate</span></span>; <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line"><span class="mxinfo " id="T17:U515"><span class="mxinfo " id="T17:U516"><span class="var type1" id="S72T1U738">Cmin</span>(<span class="mxinfo " id="T15:U518"><span class="var type1" id="S69T1U740">Ch_rate</span> &gt; <span class="var type1" id="S70T1U741">Cc_rate</span></span>)</span> = <span class="var type1" id="S70T1U743">Cc_rate</span>(<span class="mxinfo " id="T15:U522"><span class="var type1" id="S69T1U745">Ch_rate</span> &gt; <span class="var type1" id="S70T1U746">Cc_rate</span></span>)</span>;   <span class="comment">% W/K</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line"><span class="comment">% Calcluate the heat capacity rate ratio </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line"><span class="mxinfo " id="T1:U525"><span class="var type1" id="S73T1U749">Cr</span> = <span class="mxinfo " id="T1:U527"><span class="var type1" id="S72T1U751">Cmin</span>./<span class="var type1" id="S71T1U752">Cmax</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line"><span class="comment">% unitA is the size of heat exchanger area(m2) each iteration of the script</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line"><span class="comment">% uses for calculating NTU</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234">234</a></span><span class="line"><span class="comment">% unitA = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235">235</a></span><span class="line"><span class="mxinfo " id="T1:U530"><span class="var type1" id="S74T1U755">unitA</span> = <span class="mxinfo " id="T1:U532"><span class="var type1" id="S14T1U757">A</span> .* <span class="mxinfo " id="T1:U534">ones(<span class="var type1" id="S24T1U760">var_length</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236">236</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237">237</a></span><span class="line"><span class="comment">% Calculate the number of transfer units of the heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238">238</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U536">any(<span class="mxinfo " id="T15:U537"><span class="var type1" id="S14T1U767">A</span> &lt; <span class="var type1" id="S74T1U768">unitA</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239">239</a></span><span class="line">    <span class="mxinfo " id="T1:U540"><span class="var type1" id="S74T1U771">unitA</span> = <span class="mxinfo " id="T1:U542"><span class="var type1" id="S14T1U773">A</span> .* <span class="mxinfo " id="T1:U544">ones(<span class="var type1" id="S24T1U776">var_length</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240">240</a></span><span class="line"><span class="comment">%     NTU = U * A / Cmin</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241">241</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242">242</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243">243</a></span><span class="line"><span class="mxinfo " id="T1:U546"><span class="var type1" id="S76T1U780">NTU</span> = <span class="mxinfo " id="T1:U548"><span class="mxinfo " id="T1:U549"><span class="var type1" id="S13T1U783">U</span> * <span class="var type1" id="S74T1U784">unitA</span></span> ./ <span class="var type1" id="S72T1U785">Cmin</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244">244</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245">245</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246">246</a></span><span class="line"><span class="comment">% Calculate effectiveness based on type of heat exchanger</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247">247</a></span><span class="line"><span class="keyword">switch</span> <span class="var type1" id="S12T1U787">HeatExType</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248">248</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'counter'</span>  <span class="comment">% If the heat exchanger is counter-flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249">249</a></span><span class="line">        <span class="var type0" id="S77T0U792">effectiveness</span> = (1 - exp(-<span class="var type0" id="S76T0U801">NTU</span>.*(1 - <span class="var type0" id="S73T0U805">Cr</span>))) ./ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250">250</a></span><span class="line">                        (1 - <span class="var type0" id="S73T0U810">Cr</span>.*exp(-<span class="var type0" id="S76T0U815">NTU</span>.*(1 - <span class="var type0" id="S73T0U819">Cr</span>)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251">251</a></span><span class="line">    <span class="keyword">case</span> <span class="string">'parallel'</span> <span class="comment">% If the heat exchanger is parallel-flow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252">252</a></span><span class="line">        <span class="var type0" id="S77T0U824">effectiveness</span> = (1 - exp(-<span class="var type0" id="S76T0U833">NTU</span>.*(1 + <span class="var type0" id="S73T0U837">Cr</span>))) ./ <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253">253</a></span><span class="line">                        (1 + <span class="var type0" id="S73T0U841">Cr</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254">254</a></span><span class="line">    <span class="keyword">otherwise</span>       <span class="comment">% If not exchanger specified</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255">255</a></span><span class="line"><span class="comment">%         warning('No heat exchanger type specified, therefore no heat is exchanged.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256">256</a></span><span class="line">        <span class="mxinfo " id="T1:U554"><span class="var type1" id="S77T1U845">effectiveness</span> = <span class="mxinfo " id="T1:U556">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257">257</a></span><span class="line"><span class="keyword">end</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258">258</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259">259</a></span><span class="line"><span class="comment">% % However if the Cr is 0 (Cmax is inf) then effectiveness is calcluated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260">260</a></span><span class="line"><span class="comment">% % regardless of the heat exchanger flow.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261">261</a></span><span class="line"><span class="comment">% if Cr == 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262">262</a></span><span class="line"><span class="comment">%     effectiveness = 1 - exp(-NTU);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263">263</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264">264</a></span><span class="line"><span class="comment">% effectiveness;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265">265</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266">266</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267">267</a></span><span class="line"><span class="comment">% Maximum energy transfer rate is equal for an infinite length heat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268">268</a></span><span class="line"><span class="comment">% exchanger is equal to Cmin multiplied with the difference in inlet</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269">269</a></span><span class="line"><span class="comment">% temperatures. The actual energy transfer rate is the maximum rate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270">270</a></span><span class="line"><span class="comment">% multiplied by the effectiveness (Assuming no heat loss).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271">271</a></span><span class="line"><span class="mxinfo " id="T1:U557"><span class="var type1" id="S2T1U849">P</span> = <span class="mxinfo " id="T1:U559"><span class="mxinfo " id="T1:U560"><span class="var type1" id="S77T1U852">effectiveness</span>.*<span class="var type1" id="S72T1U853">Cmin</span></span>.*(<span class="mxinfo " id="T1:U563"><span class="var type1" id="S38T1U856">Thi</span> - <span class="var type1" id="S39T1U857">Tci</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272">272</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273">273</a></span><span class="line"><span class="comment">% The change in temperature is calculated for both sides by dividing the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274">274</a></span><span class="line"><span class="comment">% energy tranfer rate by the heat capacity rates for both sides. This</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275">275</a></span><span class="line"><span class="comment">% assumes the energy transfer rate is the same for both sides.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276">276</a></span><span class="line"><span class="mxinfo " id="T1:U566"><span class="var type1" id="S79T1U860">deltaTh</span> = <span class="mxinfo " id="T1:U568"><span class="var type1" id="S2T1U862">P</span>./<span class="var type1" id="S69T1U863">Ch_rate</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277">277</a></span><span class="line"><span class="mxinfo " id="T1:U571"><span class="var type1" id="S80T1U866">deltaTc</span> = <span class="mxinfo " id="T1:U573"><span class="var type1" id="S2T1U868">P</span>./<span class="var type1" id="S70T1U869">Cc_rate</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278">278</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279">279</a></span><span class="line"><span class="comment">% The outlet temperatures are caluctaed by subtracting the change in</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280">280</a></span><span class="line"><span class="comment">% temperature from the hot fluid inlet temperature and adding the change in</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281">281</a></span><span class="line"><span class="comment">% temperature from the cool fluid inlet temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282">282</a></span><span class="line"><span class="mxinfo " id="T1:U576"><span class="var type1" id="S81T1U872">Tho</span> = <span class="mxinfo " id="T1:U578"><span class="var type1" id="S38T1U874">Thi</span> - <span class="var type1" id="S79T1U875">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283">283</a></span><span class="line"><span class="mxinfo " id="T1:U581"><span class="var type1" id="S82T1U878">Tco</span> = <span class="mxinfo " id="T1:U583"><span class="var type1" id="S39T1U880">Tci</span> + <span class="var type1" id="S80T1U881">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284">284</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285">285</a></span><span class="line"><span class="comment">% Determine Hho and Hco values based off of Tho and Tco values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286">286</a></span><span class="line"><span class="comment">% Initialize Hho and Hco values and pointers and Tho &amp; Tco pointers</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287">287</a></span><span class="line"><span class="mxinfo " id="T5:U586"><span class="var type1" id="S83T5U884">Tho_Ptr</span> = <span class="mxinfo " id="T5:U588"><span class="extrinsicFcn" id="F99N8:B886">libpointer</span>(<span class="mxinfo " id="T9:U589"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S81T1U888">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288">288</a></span><span class="line"><span class="mxinfo " id="T5:U591"><span class="var type1" id="S84T5U891">Tco_Ptr</span> = <span class="mxinfo " id="T5:U593"><span class="extrinsicFcn" id="F100N8:B893">libpointer</span>(<span class="mxinfo " id="T9:U594"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U895">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289">289</a></span><span class="line"><span class="mxinfo " id="T1:U596"><span class="var type1" id="S85T1U898">Hho</span> = <span class="mxinfo " id="T1:U598">zeros(<span class="var type1" id="S24T1U901">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290">290</a></span><span class="line"><span class="mxinfo " id="T1:U600"><span class="var type1" id="S86T1U905">Hco</span> = <span class="mxinfo " id="T1:U602">zeros(<span class="var type1" id="S24T1U908">var_length</span>,1)</span></span>; <span class="comment">% initialized to 0 temporarily</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291">291</a></span><span class="line"><span class="mxinfo " id="T5:U604"><span class="var type1" id="S87T5U912">Hho_Ptr</span> = <span class="mxinfo " id="T5:U606"><span class="extrinsicFcn" id="F101N8:B914">libpointer</span>(<span class="mxinfo " id="T9:U607"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S85T1U916">Hho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292">292</a></span><span class="line"><span class="mxinfo " id="T5:U609"><span class="var type1" id="S88T5U919">Hco_Ptr</span> = <span class="mxinfo " id="T5:U611"><span class="extrinsicFcn" id="F102N8:B921">libpointer</span>(<span class="mxinfo " id="T9:U612"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S86T1U923">Hco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293">293</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294">294</a></span><span class="line"><span class="comment">% Update values located at Hho and Hco pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295">295</a></span><span class="line"><span class="mxinfo " id="T5:U614"><span class="extrinsicFcn" id="F103N3:B926">calllib</span>(<span class="mxinfo " id="T6:U615"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U616"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U929">handle_h</span>, <span class="var type1" id="S30T5U930">pt_ind</span>, <span class="var type1" id="S35T5U931">p_h_Ptr</span>, <span class="var type1" id="S83T5U932">Tho_Ptr</span>, <span class="var type1" id="S24T1U933">var_length</span>, <span class="var type1" id="S33T5U934">h_ind</span>, <span class="var type1" id="S87T5U935">Hho_Ptr</span>, <span class="var type1" id="S18T1U936">ierr</span>,<span class="var type1" id="S20T3U937">herr</span>,<span class="var type1" id="S17T1U938">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296">296</a></span><span class="line"><span class="mxinfo " id="T5:U627"><span class="extrinsicFcn" id="F104N3:B941">calllib</span>(<span class="mxinfo " id="T6:U628"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U629"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U944">handle_c</span>, <span class="var type1" id="S30T5U945">pt_ind</span>, <span class="var type1" id="S37T5U946">p_c_Ptr</span>, <span class="var type1" id="S84T5U947">Tco_Ptr</span>, <span class="var type1" id="S24T1U948">var_length</span>, <span class="var type1" id="S33T5U949">h_ind</span>, <span class="var type1" id="S88T5U950">Hco_Ptr</span>, <span class="var type1" id="S18T1U951">ierr</span>,<span class="var type1" id="S20T3U952">herr</span>,<span class="var type1" id="S17T1U953">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297">297</a></span><span class="line"><span class="comment">% Set Hho &amp; Hco to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298">298</a></span><span class="line"><span class="mxinfo " id="T1:U640"><span class="var type1" id="S85T1U956">Hho</span> = <span class="mxinfo " id="T5:U642"><span class="extrinsicFcn" id="F105N7:B958">get</span>(<span class="var type1" id="S87T5U959">Hho_Ptr</span>,<span class="mxinfo " id="T13:U644"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299">299</a></span><span class="line"><span class="mxinfo " id="T1:U645"><span class="var type1" id="S86T1U963">Hco</span> = <span class="mxinfo " id="T5:U647"><span class="extrinsicFcn" id="F106N7:B965">get</span>(<span class="var type1" id="S88T5U966">Hco_Ptr</span>,<span class="mxinfo " id="T13:U649"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300">300</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301">301</a></span><span class="line"><span class="comment">% The coolprop return may be inaccurate if Tho = vaporization temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302">302</a></span><span class="line"><span class="comment">% For those values Ho = Hi - P/m_dot</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303">303</a></span><span class="line"><span class="mxinfo " id="T17:U650"><span class="mxinfo " id="T17:U651"><span class="var type1" id="S85T1U971">Hho</span>(<span class="mxinfo " id="T15:U653"><span class="mxinfo " id="T1:U654">abs(<span class="mxinfo " id="T1:U655"><span class="var type1" id="S38T1U976">Thi</span> - <span class="var type1" id="S50T1U977">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U658">1e-4</span></span>)</span> =  <span class="mxinfo " id="T17:U659"><span class="var type1" id="S42T1U981">Hhi</span>(<span class="mxinfo " id="T15:U661"><span class="mxinfo " id="T1:U662">abs(<span class="mxinfo " id="T1:U663"><span class="var type1" id="S38T1U986">Thi</span> - <span class="var type1" id="S50T1U987">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U666">1e-4</span></span>) <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304">304</a></span><span class="line">    - <span class="mxinfo " id="T17:U667"><span class="mxinfo " id="T17:U668"><span class="var type1" id="S2T1U991">P</span>(<span class="mxinfo " id="T15:U670"><span class="mxinfo " id="T1:U671">abs(<span class="mxinfo " id="T1:U672"><span class="var type1" id="S38T1U996">Thi</span> - <span class="var type1" id="S50T1U997">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U675">1e-4</span></span>)</span>./<span class="mxinfo " id="T17:U676"><span class="var type1" id="S6T1U1000">m_dot_h</span>(<span class="mxinfo " id="T15:U678"><span class="mxinfo " id="T1:U679">abs(<span class="mxinfo " id="T1:U680"><span class="var type1" id="S38T1U1005">Thi</span> - <span class="var type1" id="S50T1U1006">Tvh</span></span>)</span> &lt; <span class="mxinfo " id="T1:U683">1e-4</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305">305</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306">306</a></span><span class="line"><span class="comment">% The coolprop return may be inaccurate if Tco = vaporization temperature.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307">307</a></span><span class="line"><span class="comment">% For those values Ho = Hi - P/m_dot</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308">308</a></span><span class="line"><span class="mxinfo " id="T17:U684"><span class="mxinfo " id="T17:U685"><span class="var type1" id="S86T1U1011">Hco</span>(<span class="mxinfo " id="T15:U687"><span class="mxinfo " id="T1:U688">abs(<span class="mxinfo " id="T1:U689"><span class="var type1" id="S39T1U1016">Tci</span> - <span class="var type1" id="S51T1U1017">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U692">1e-4</span></span>)</span> =  <span class="mxinfo " id="T17:U693"><span class="var type1" id="S44T1U1021">Hci</span>(<span class="mxinfo " id="T15:U695"><span class="mxinfo " id="T1:U696">abs(<span class="mxinfo " id="T1:U697"><span class="var type1" id="S39T1U1026">Tci</span> - <span class="var type1" id="S51T1U1027">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U700">1e-4</span></span>) <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309">309</a></span><span class="line">    - <span class="mxinfo " id="T17:U701"><span class="mxinfo " id="T17:U702"><span class="var type1" id="S2T1U1031">P</span>(<span class="mxinfo " id="T15:U704"><span class="mxinfo " id="T1:U705">abs(<span class="mxinfo " id="T1:U706"><span class="var type1" id="S39T1U1036">Tci</span> - <span class="var type1" id="S51T1U1037">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U709">1e-4</span></span>)</span>./<span class="mxinfo " id="T17:U710"><span class="var type1" id="S9T1U1040">m_dot_c</span>(<span class="mxinfo " id="T15:U712"><span class="mxinfo " id="T1:U713">abs(<span class="mxinfo " id="T1:U714"><span class="var type1" id="S39T1U1045">Tci</span> - <span class="var type1" id="S51T1U1046">Tvc</span></span>)</span> &lt; <span class="mxinfo " id="T1:U717">1e-4</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310">310</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311">311</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312">312</a></span><span class="line"><span class="comment">% check if hot fluid begins to condense </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313">313</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U718">any(<span class="mxinfo " id="T15:U719"><span class="mxinfo " id="T15:U720"><span class="var type1" id="S85T1U1054">Hho</span> &lt;= <span class="var type1" id="S59T1U1055">Hvh_max</span></span> &amp; <span class="mxinfo " id="T15:U723"><span class="var type1" id="S42T1U1057">Hhi</span> &gt; <span class="var type1" id="S59T1U1058">Hvh_max</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314">314</a></span><span class="line"><span class="comment">% if Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315">315</a></span><span class="line">    <span class="mxinfo " id="T5:U726"><span class="autoExtrinsicFcn" id="F120N4:B1061">disp</span>(<span class="mxinfo " id="T18:U727"><span class="string">'~~~~~~~~~~~~~~~~~~~Condensation start~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316">316</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317">317</a></span><span class="line"><span class="comment">%     Get the indecies where condensation starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318">318</a></span><span class="line">    <span class="mxinfo " id="T15:U728"><span class="var type1" id="S90T15U1065">cond_start_ind</span> = (<span class="mxinfo " id="T15:U730"><span class="mxinfo " id="T15:U731"><span class="var type1" id="S85T1U1069">Hho</span> &lt;= <span class="var type1" id="S59T1U1070">Hvh_max</span></span> &amp; <span class="mxinfo " id="T15:U734"><span class="var type1" id="S42T1U1072">Hhi</span> &gt; <span class="var type1" id="S59T1U1073">Hvh_max</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319">319</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320">320</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to maximum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321">321</a></span><span class="line"><span class="comment">%     vaporization region (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322">322</a></span><span class="line">    <span class="mxinfo " id="T17:U737"><span class="mxinfo " id="T17:U738"><span class="var type1" id="S85T1U1077">Hho</span>(<span class="var type1" id="S90T15U1078">cond_start_ind</span>)</span> = <span class="var type1" id="S59T1U1080">Hvh_max</span>(<span class="var type1" id="S90T15U1081">cond_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323">323</a></span><span class="line">    <span class="mxinfo " id="T17:U743"><span class="mxinfo " id="T17:U744"><span class="var type1" id="S81T1U1085">Tho</span>(<span class="var type1" id="S90T15U1086">cond_start_ind</span>)</span> = <span class="var type1" id="S50T1U1088">Tvh</span>(<span class="var type1" id="S90T15U1089">cond_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324">324</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325">325</a></span><span class="line"><span class="comment">%     Calculate power needed to bring hot fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326">326</a></span><span class="line"><span class="comment">%     precondense for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327">327</a></span><span class="line">    <span class="mxinfo " id="T17:U749"><span class="var type1" id="S91T17U1092">P_init_to_precondense</span> = <span class="mxinfo " id="T17:U751">(<span class="mxinfo " id="T17:U752"><span class="var type1" id="S42T1U1097">Hhi</span>(<span class="var type1" id="S90T15U1098">cond_start_ind</span>) - <span class="var type1" id="S85T1U1100">Hho</span>(<span class="var type1" id="S90T15U1101">cond_start_ind</span>)</span>).*<span class="var type1" id="S6T1U1103">m_dot_h</span>(<span class="var type1" id="S90T15U1104">cond_start_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328">328</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329">329</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent cool fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330">330</a></span><span class="line">    <span class="mxinfo " id="T17:U759"><span class="var type1" id="S80T17U1107">deltaTc</span> = <span class="mxinfo " id="T17:U761"><span class="var type1" id="S91T17U1109">P_init_to_precondense</span>./<span class="mxinfo " id="T17:U763"><span class="var type1" id="S70T1U1111">Cc_rate</span>(<span class="var type1" id="S90T15U1112">cond_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331">331</a></span><span class="line"><span class="comment">%     Update relavent cool fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332">332</a></span><span class="line">    <span class="mxinfo " id="T17:U766"><span class="mxinfo " id="T17:U767"><span class="var type1" id="S82T1U1116">Tco</span>(<span class="var type1" id="S90T15U1117">cond_start_ind</span>)</span> = <span class="mxinfo " id="T17:U770"><span class="var type1" id="S39T1U1120">Tci</span>(<span class="var type1" id="S90T15U1121">cond_start_ind</span>) + <span class="var type1" id="S80T17U1122">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333">333</a></span><span class="line">    <span class="mxinfo " id="T5:U774"><span class="var type1" id="S84T5U1125">Tco_Ptr</span> = <span class="mxinfo " id="T5:U776"><span class="extrinsicFcn" id="F121N8:B1127">libpointer</span>(<span class="mxinfo " id="T9:U777"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U1129">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334">334</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335">335</a></span><span class="line"><span class="comment">%     Update H values for new cool output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336">336</a></span><span class="line">    <span class="mxinfo " id="T5:U779"><span class="extrinsicFcn" id="F122N3:B1132">calllib</span>(<span class="mxinfo " id="T6:U780"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U781"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1135">handle_c</span>, <span class="var type1" id="S30T5U1136">pt_ind</span>, <span class="var type1" id="S37T5U1137">p_c_Ptr</span>, <span class="var type1" id="S84T5U1138">Tco_Ptr</span>, <span class="var type1" id="S24T1U1139">var_length</span>, <span class="var type1" id="S33T5U1140">h_ind</span>, <span class="var type1" id="S88T5U1141">Hco_Ptr</span>, <span class="var type1" id="S18T1U1142">ierr</span>,<span class="var type1" id="S20T3U1143">herr</span>,<span class="var type1" id="S17T1U1144">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337">337</a></span><span class="line">    <span class="mxinfo " id="T1:U792"><span class="var type1" id="S86T1U1147">Hco</span> = <span class="mxinfo " id="T5:U794"><span class="extrinsicFcn" id="F123N7:B1149">get</span>(<span class="var type1" id="S88T5U1150">Hco_Ptr</span>,<span class="mxinfo " id="T13:U796"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338">338</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339">339</a></span><span class="line"><span class="comment">%     Calculate ratio of power to precondense state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340">340</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341">341</a></span><span class="line">    <span class="mxinfo " id="T17:U797"><span class="var type1" id="S92T17U1154">PowerFrac_Condense_over_NoCondense</span> = <span class="mxinfo " id="T17:U799"><span class="var type1" id="S91T17U1156">P_init_to_precondense</span>./<span class="mxinfo " id="T17:U801"><span class="var type1" id="S2T1U1158">P</span>(<span class="var type1" id="S90T15U1159">cond_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342">342</a></span><span class="line">    <span class="mxinfo " id="T17:U804"><span class="mxinfo " id="T17:U805"><span class="var type1" id="S74T1U1163">unitA</span>(<span class="var type1" id="S90T15U1164">cond_start_ind</span>)</span> = <span class="mxinfo " id="T17:U808"><span class="mxinfo " id="T17:U809"><span class="var type1" id="S74T1U1167">unitA</span>(<span class="var type1" id="S90T15U1168">cond_start_ind</span>)</span>*<span class="var type1" id="S92T17U1169">PowerFrac_Condense_over_NoCondense</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343">343</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344">344</a></span><span class="line">    <span class="mxinfo " id="T17:U813"><span class="mxinfo " id="T17:U814"><span class="var type1" id="S2T1U1173">P</span>(<span class="var type1" id="S90T15U1174">cond_start_ind</span>)</span> = <span class="var type1" id="S91T17U1175">P_init_to_precondense</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345">345</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346">346</a></span><span class="line"><span class="comment">% check if hot fluid finishes condensing    </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347">347</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U818">any(<span class="mxinfo " id="T15:U819"><span class="mxinfo " id="T15:U820"><span class="var type1" id="S85T1U1181">Hho</span> &lt;= <span class="var type1" id="S54T1U1182">Hvh_min</span></span> &amp; <span class="mxinfo " id="T15:U823"><span class="var type1" id="S42T1U1184">Hhi</span> &gt; <span class="var type1" id="S54T1U1185">Hvh_min</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348">348</a></span><span class="line"><span class="comment">% elseif Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349">349</a></span><span class="line">    <span class="mxinfo " id="T5:U826"><span class="autoExtrinsicFcn" id="F129N4:B1188">disp</span>(<span class="mxinfo " id="T19:U827"><span class="string">'~~~~~~~~~~~~~~~~~~~~~~Condensation end~~~~~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350">350</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351">351</a></span><span class="line"><span class="comment">%     Get the indecies where condensation starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352">352</a></span><span class="line">    <span class="mxinfo " id="T15:U828"><span class="var type1" id="S93T15U1192">cond_end_ind</span> = (<span class="mxinfo " id="T15:U830"><span class="mxinfo " id="T15:U831"><span class="var type1" id="S85T1U1196">Hho</span> &lt;= <span class="var type1" id="S54T1U1197">Hvh_min</span></span> &amp; <span class="mxinfo " id="T15:U834"><span class="var type1" id="S42T1U1199">Hhi</span> &gt; <span class="var type1" id="S54T1U1200">Hvh_min</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353">353</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354">354</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to minimum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355">355</a></span><span class="line"><span class="comment">%     vaporization region (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356">356</a></span><span class="line">    <span class="mxinfo " id="T17:U837"><span class="mxinfo " id="T17:U838"><span class="var type1" id="S85T1U1204">Hho</span>(<span class="var type1" id="S93T15U1205">cond_end_ind</span>)</span> = <span class="var type1" id="S54T1U1207">Hvh_min</span>(<span class="var type1" id="S93T15U1208">cond_end_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357">357</a></span><span class="line">    <span class="mxinfo " id="T17:U843"><span class="mxinfo " id="T17:U844"><span class="var type1" id="S81T1U1212">Tho</span>(<span class="var type1" id="S93T15U1213">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U847"><span class="var type1" id="S50T1U1216">Tvh</span>(<span class="var type1" id="S93T15U1217">cond_end_ind</span>) - <span class="mxinfo " id="T1:U850">1e-4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358">358</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359">359</a></span><span class="line"><span class="comment">%     Calculate power needed to bring hot fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360">360</a></span><span class="line"><span class="comment">%     postcondense for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361">361</a></span><span class="line">    <span class="mxinfo " id="T17:U851"><span class="var type1" id="S94T17U1221">P_init_to_postcondense</span> = <span class="mxinfo " id="T17:U853">(<span class="mxinfo " id="T17:U854"><span class="var type1" id="S42T1U1226">Hhi</span>(<span class="var type1" id="S93T15U1227">cond_end_ind</span>) - <span class="var type1" id="S85T1U1229">Hho</span>(<span class="var type1" id="S93T15U1230">cond_end_ind</span>)</span>).*<span class="var type1" id="S6T1U1232">m_dot_h</span>(<span class="var type1" id="S93T15U1233">cond_end_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362">362</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363">363</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent cool fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364">364</a></span><span class="line">    <span class="mxinfo " id="T17:U861"><span class="var type1" id="S80T17U1236">deltaTc</span> = <span class="mxinfo " id="T17:U863"><span class="var type1" id="S94T17U1238">P_init_to_postcondense</span>./<span class="mxinfo " id="T17:U865"><span class="var type1" id="S70T1U1240">Cc_rate</span>(<span class="var type1" id="S93T15U1241">cond_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365">365</a></span><span class="line"><span class="comment">%     Update relavent cool fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366">366</a></span><span class="line">    <span class="mxinfo " id="T17:U868"><span class="mxinfo " id="T17:U869"><span class="var type1" id="S82T1U1245">Tco</span>(<span class="var type1" id="S93T15U1246">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U872"><span class="var type1" id="S39T1U1249">Tci</span>(<span class="var type1" id="S93T15U1250">cond_end_ind</span>) + <span class="var type1" id="S80T17U1251">deltaTc</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367">367</a></span><span class="line">    <span class="mxinfo " id="T5:U876"><span class="var type1" id="S84T5U1254">Tco_Ptr</span> = <span class="mxinfo " id="T5:U878"><span class="extrinsicFcn" id="F130N8:B1256">libpointer</span>(<span class="mxinfo " id="T9:U879"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S82T1U1258">Tco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368">368</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369">369</a></span><span class="line"><span class="comment">%     Update H values for new cool output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370">370</a></span><span class="line">    <span class="mxinfo " id="T5:U881"><span class="extrinsicFcn" id="F131N3:B1261">calllib</span>(<span class="mxinfo " id="T6:U882"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U883"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1264">handle_c</span>, <span class="var type1" id="S30T5U1265">pt_ind</span>, <span class="var type1" id="S37T5U1266">p_c_Ptr</span>, <span class="var type1" id="S84T5U1267">Tco_Ptr</span>, <span class="var type1" id="S24T1U1268">var_length</span>, <span class="var type1" id="S33T5U1269">h_ind</span>, <span class="var type1" id="S88T5U1270">Hco_Ptr</span>, <span class="var type1" id="S18T1U1271">ierr</span>,<span class="var type1" id="S20T3U1272">herr</span>,<span class="var type1" id="S17T1U1273">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371">371</a></span><span class="line">    <span class="mxinfo " id="T1:U894"><span class="var type1" id="S86T1U1276">Hco</span> = <span class="mxinfo " id="T5:U896"><span class="extrinsicFcn" id="F132N7:B1278">get</span>(<span class="var type1" id="S88T5U1279">Hco_Ptr</span>,<span class="mxinfo " id="T13:U898"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372">372</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373">373</a></span><span class="line"><span class="comment">%     Calculate ratio of power to postcondense state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374">374</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375">375</a></span><span class="line">    <span class="mxinfo " id="T17:U899"><span class="var type1" id="S92T17U1283">PowerFrac_Condense_over_NoCondense</span> = <span class="mxinfo " id="T17:U901"><span class="var type1" id="S94T17U1285">P_init_to_postcondense</span>./<span class="mxinfo " id="T17:U903"><span class="var type1" id="S2T1U1287">P</span>(<span class="var type1" id="S93T15U1288">cond_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376">376</a></span><span class="line">    <span class="mxinfo " id="T17:U906"><span class="mxinfo " id="T17:U907"><span class="var type1" id="S74T1U1292">unitA</span>(<span class="var type1" id="S93T15U1293">cond_end_ind</span>)</span> = <span class="mxinfo " id="T17:U910"><span class="mxinfo " id="T17:U911"><span class="var type1" id="S74T1U1296">unitA</span>(<span class="var type1" id="S93T15U1297">cond_end_ind</span>)</span>*<span class="var type1" id="S92T17U1298">PowerFrac_Condense_over_NoCondense</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377">377</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378">378</a></span><span class="line">    <span class="mxinfo " id="T17:U915"><span class="mxinfo " id="T17:U916"><span class="var type1" id="S2T1U1302">P</span>(<span class="var type1" id="S93T15U1303">cond_end_ind</span>)</span> = <span class="var type1" id="S94T17U1304">P_init_to_postcondense</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379">379</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380">380</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381">381</a></span><span class="line"><span class="comment">% else check if cool fluid begins to vaporize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382">382</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U920">any(<span class="mxinfo " id="T15:U921"><span class="mxinfo " id="T15:U922"><span class="var type1" id="S86T1U1310">Hco</span> &gt;= <span class="var type1" id="S55T1U1311">Hvc_min</span></span> &amp; <span class="mxinfo " id="T15:U925"><span class="var type1" id="S44T1U1313">Hci</span> &lt; <span class="var type1" id="S55T1U1314">Hvc_min</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383">383</a></span><span class="line"><span class="comment">% elseif Tco &gt;= Tvc &amp;&amp; Tci &lt;= Tvc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384">384</a></span><span class="line">   <span class="mxinfo " id="T5:U928"><span class="autoExtrinsicFcn" id="F133N4:B1317">disp</span>(<span class="mxinfo " id="T20:U929"><span class="string">'~~~~~~~~~~~~~~~~~~~Vaporization start~~~~~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385">385</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386">386</a></span><span class="line"><span class="comment">%     Get the indecies where vaporization starts</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387">387</a></span><span class="line">    <span class="mxinfo " id="T15:U930"><span class="var type1" id="S95T15U1321">vap_start_ind</span> = (<span class="mxinfo " id="T15:U932"><span class="mxinfo " id="T15:U933"><span class="var type1" id="S86T1U1325">Hco</span> &gt;= <span class="var type1" id="S55T1U1326">Hvc_min</span></span> &amp; <span class="mxinfo " id="T15:U936"><span class="var type1" id="S44T1U1328">Hci</span> &lt; <span class="var type1" id="S55T1U1329">Hvc_min</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388">388</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389">389</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to minimum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390">390</a></span><span class="line"><span class="comment">%     vaporization region (Q = 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391">391</a></span><span class="line">    <span class="mxinfo " id="T17:U939"><span class="mxinfo " id="T17:U940"><span class="var type1" id="S86T1U1333">Hco</span>(<span class="var type1" id="S95T15U1334">vap_start_ind</span>)</span> = <span class="var type1" id="S55T1U1336">Hvc_min</span>(<span class="var type1" id="S95T15U1337">vap_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392">392</a></span><span class="line">    <span class="mxinfo " id="T17:U945"><span class="mxinfo " id="T17:U946"><span class="var type1" id="S82T1U1341">Tco</span>(<span class="var type1" id="S95T15U1342">vap_start_ind</span>)</span> = <span class="var type1" id="S51T1U1344">Tvc</span>(<span class="var type1" id="S95T15U1345">vap_start_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393">393</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,394" id="srcline394">394</a></span><span class="line"><span class="comment">%     Calculate power needed to bring cool fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,395" id="srcline395">395</a></span><span class="line"><span class="comment">%     prevaporization for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,396" id="srcline396">396</a></span><span class="line">    <span class="mxinfo " id="T17:U951"><span class="var type1" id="S96T17U1348">P_init_to_prevap</span> = <span class="mxinfo " id="T17:U953">(<span class="mxinfo " id="T17:U954"><span class="var type1" id="S86T1U1353">Hco</span>(<span class="var type1" id="S95T15U1354">vap_start_ind</span>) - <span class="var type1" id="S44T1U1356">Hci</span>(<span class="var type1" id="S95T15U1357">vap_start_ind</span>)</span>).*<span class="var type1" id="S9T1U1359">m_dot_c</span>(<span class="var type1" id="S95T15U1360">vap_start_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,397" id="srcline397">397</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,398" id="srcline398">398</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent hot fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,399" id="srcline399">399</a></span><span class="line">    <span class="mxinfo " id="T17:U961"><span class="var type1" id="S79T17U1363">deltaTh</span> = <span class="mxinfo " id="T17:U963"><span class="var type1" id="S96T17U1365">P_init_to_prevap</span>./<span class="mxinfo " id="T17:U965"><span class="var type1" id="S69T1U1367">Ch_rate</span>(<span class="var type1" id="S95T15U1368">vap_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,400" id="srcline400">400</a></span><span class="line"><span class="comment">%     Update relavent hot fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,401" id="srcline401">401</a></span><span class="line">    <span class="mxinfo " id="T17:U968"><span class="mxinfo " id="T17:U969"><span class="var type1" id="S81T1U1372">Tho</span>(<span class="var type1" id="S95T15U1373">vap_start_ind</span>)</span> = <span class="mxinfo " id="T17:U972"><span class="var type1" id="S38T1U1376">Thi</span>(<span class="var type1" id="S95T15U1377">vap_start_ind</span>) - <span class="var type1" id="S79T17U1378">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,402" id="srcline402">402</a></span><span class="line">    <span class="mxinfo " id="T5:U976"><span class="var type1" id="S83T5U1381">Tho_Ptr</span> = <span class="mxinfo " id="T5:U978"><span class="extrinsicFcn" id="F134N8:B1383">libpointer</span>(<span class="mxinfo " id="T9:U979"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S81T1U1385">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,403" id="srcline403">403</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,404" id="srcline404">404</a></span><span class="line"><span class="comment">%     Update H values for new hot output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,405" id="srcline405">405</a></span><span class="line">    <span class="mxinfo " id="T5:U981"><span class="extrinsicFcn" id="F135N3:B1388">calllib</span>(<span class="mxinfo " id="T6:U982"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U983"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1391">handle_h</span>, <span class="var type1" id="S30T5U1392">pt_ind</span>, <span class="var type1" id="S35T5U1393">p_h_Ptr</span>, <span class="var type1" id="S83T5U1394">Tho_Ptr</span>, <span class="var type1" id="S24T1U1395">var_length</span>, <span class="var type1" id="S33T5U1396">h_ind</span>, <span class="var type1" id="S87T5U1397">Hho_Ptr</span>, <span class="var type1" id="S18T1U1398">ierr</span>,<span class="var type1" id="S20T3U1399">herr</span>,<span class="var type1" id="S17T1U1400">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,406" id="srcline406">406</a></span><span class="line">    <span class="mxinfo " id="T1:U994"><span class="var type1" id="S85T1U1403">Hho</span> = <span class="mxinfo " id="T5:U996"><span class="extrinsicFcn" id="F136N7:B1405">get</span>(<span class="var type1" id="S87T5U1406">Hho_Ptr</span>,<span class="mxinfo " id="T13:U998"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,407" id="srcline407">407</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,408" id="srcline408">408</a></span><span class="line"><span class="comment">%     Calculate ratio of power to prevaporize state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409">409</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,410" id="srcline410">410</a></span><span class="line">    <span class="mxinfo " id="T17:U999"><span class="var type1" id="S97T17U1410">PowerFrac_Vaporize_over_NoVaporize</span> = <span class="mxinfo " id="T17:U1001"><span class="var type1" id="S96T17U1412">P_init_to_prevap</span>./<span class="mxinfo " id="T17:U1003"><span class="var type1" id="S2T1U1414">P</span>(<span class="var type1" id="S95T15U1415">vap_start_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,411" id="srcline411">411</a></span><span class="line">    <span class="mxinfo " id="T17:U1006"><span class="mxinfo " id="T17:U1007"><span class="var type1" id="S74T1U1419">unitA</span>(<span class="var type1" id="S95T15U1420">vap_start_ind</span>)</span> = <span class="mxinfo " id="T17:U1010"><span class="var type1" id="S74T1U1423">unitA</span>(<span class="var type1" id="S95T15U1424">vap_start_ind</span>).*<span class="var type1" id="S97T17U1425">PowerFrac_Vaporize_over_NoVaporize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,412" id="srcline412">412</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,413" id="srcline413">413</a></span><span class="line">    <span class="mxinfo " id="T17:U1014"><span class="mxinfo " id="T17:U1015"><span class="var type1" id="S2T1U1429">P</span>(<span class="var type1" id="S95T15U1430">vap_start_ind</span>)</span> = <span class="var type1" id="S96T17U1431">P_init_to_prevap</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,414" id="srcline414">414</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,415" id="srcline415">415</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,416" id="srcline416">416</a></span><span class="line"><span class="comment">% check if cool fluid finishes vaporizing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417">417</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T15:U1019">any(<span class="mxinfo " id="T15:U1020"><span class="mxinfo " id="T15:U1021"><span class="var type1" id="S86T1U1437">Hco</span> &gt;= <span class="var type1" id="S60T1U1438">Hvc_max</span></span> &amp; <span class="mxinfo " id="T15:U1024"><span class="var type1" id="S44T1U1440">Hci</span> &lt; <span class="var type1" id="S60T1U1441">Hvc_max</span></span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418">418</a></span><span class="line"><span class="comment">% elseif Tho &lt;= Tvh &amp;&amp; Thi &gt;= Tvh</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419">419</a></span><span class="line">    <span class="mxinfo " id="T5:U1027"><span class="autoExtrinsicFcn" id="F137N4:B1444">disp</span>(<span class="mxinfo " id="T21:U1028"><span class="string">'~~~~~~~~~~~~~~~~Vaporization end~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420">420</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421">421</a></span><span class="line"><span class="comment">%     Get the indecies where vaporization ends</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422">422</a></span><span class="line">    <span class="mxinfo " id="T15:U1029"><span class="var type1" id="S98T15U1448">vap_end_ind</span> = (<span class="mxinfo " id="T15:U1031"><span class="mxinfo " id="T15:U1032"><span class="var type1" id="S86T1U1452">Hco</span> &gt;= <span class="var type1" id="S60T1U1453">Hvc_max</span></span> &amp; <span class="mxinfo " id="T15:U1035"><span class="var type1" id="S44T1U1455">Hci</span> &lt; <span class="var type1" id="S60T1U1456">Hvc_max</span></span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423">423</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424">424</a></span><span class="line"><span class="comment">%     Set the H output of the appropriate values to maximum value in the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425">425</a></span><span class="line"><span class="comment">%     vaporization region (Q = 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426">426</a></span><span class="line">    <span class="mxinfo " id="T17:U1038"><span class="mxinfo " id="T17:U1039"><span class="var type1" id="S86T1U1460">Hco</span>(<span class="var type1" id="S98T15U1461">vap_end_ind</span>)</span> = <span class="var type1" id="S60T1U1463">Hvc_max</span>(<span class="var type1" id="S98T15U1464">vap_end_ind</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427">427</a></span><span class="line">    <span class="mxinfo " id="T17:U1044"><span class="mxinfo " id="T17:U1045"><span class="var type1" id="S82T1U1468">Tco</span>(<span class="var type1" id="S98T15U1469">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U1048"><span class="var type1" id="S51T1U1472">Tvc</span>(<span class="var type1" id="S98T15U1473">vap_end_ind</span>) + <span class="mxinfo " id="T1:U1051">1e-4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428">428</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429">429</a></span><span class="line"><span class="comment">%     Calculate power needed to bring cool fluid initial state to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430">430</a></span><span class="line"><span class="comment">%     postvaporization for only relevant values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431">431</a></span><span class="line">    <span class="mxinfo " id="T17:U1052"><span class="var type1" id="S99T17U1477">P_init_to_postvap</span> = <span class="mxinfo " id="T17:U1054">(<span class="mxinfo " id="T17:U1055"><span class="var type1" id="S86T1U1482">Hco</span>(<span class="var type1" id="S98T15U1483">vap_end_ind</span>) - <span class="var type1" id="S44T1U1485">Hci</span>(<span class="var type1" id="S98T15U1486">vap_end_ind</span>)</span>).*<span class="var type1" id="S9T1U1488">m_dot_c</span>(<span class="var type1" id="S98T15U1489">vap_end_ind</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432">432</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433">433</a></span><span class="line"><span class="comment">%     Calculate change in temperature for relavent hot fluid values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434">434</a></span><span class="line">    <span class="mxinfo " id="T17:U1062"><span class="var type1" id="S79T17U1492">deltaTh</span> = <span class="mxinfo " id="T17:U1064"><span class="var type1" id="S99T17U1494">P_init_to_postvap</span>./<span class="mxinfo " id="T17:U1066"><span class="var type1" id="S69T1U1496">Ch_rate</span>(<span class="var type1" id="S98T15U1497">vap_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435">435</a></span><span class="line"><span class="comment">%     Update relavent hot fluid output temperatures and get new pointer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436">436</a></span><span class="line">    <span class="mxinfo " id="T17:U1069"><span class="mxinfo " id="T17:U1070"><span class="var type1" id="S81T1U1501">Tho</span>(<span class="var type1" id="S98T15U1502">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U1073"><span class="var type1" id="S38T1U1505">Thi</span>(<span class="var type1" id="S98T15U1506">vap_end_ind</span>) - <span class="var type1" id="S79T17U1507">deltaTh</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437">437</a></span><span class="line">    <span class="mxinfo " id="T5:U1077"><span class="var type1" id="S83T5U1510">Tho_Ptr</span> = <span class="mxinfo " id="T5:U1079"><span class="extrinsicFcn" id="F138N8:B1512">libpointer</span>(<span class="mxinfo " id="T9:U1080"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S81T1U1514">Tho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438">438</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439">439</a></span><span class="line"><span class="comment">%     Update H values for new hot output temperatures</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,440" id="srcline440">440</a></span><span class="line">    <span class="mxinfo " id="T5:U1082"><span class="extrinsicFcn" id="F139N3:B1517">calllib</span>(<span class="mxinfo " id="T6:U1083"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1084"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1520">handle_h</span>, <span class="var type1" id="S30T5U1521">pt_ind</span>, <span class="var type1" id="S35T5U1522">p_h_Ptr</span>, <span class="var type1" id="S83T5U1523">Tho_Ptr</span>, <span class="var type1" id="S24T1U1524">var_length</span>, <span class="var type1" id="S33T5U1525">h_ind</span>, <span class="var type1" id="S87T5U1526">Hho_Ptr</span>, <span class="var type1" id="S18T1U1527">ierr</span>,<span class="var type1" id="S20T3U1528">herr</span>,<span class="var type1" id="S17T1U1529">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,441" id="srcline441">441</a></span><span class="line">    <span class="mxinfo " id="T1:U1095"><span class="var type1" id="S85T1U1532">Hho</span> = <span class="mxinfo " id="T5:U1097"><span class="extrinsicFcn" id="F140N7:B1534">get</span>(<span class="var type1" id="S87T5U1535">Hho_Ptr</span>,<span class="mxinfo " id="T13:U1099"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,442" id="srcline442">442</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,443" id="srcline443">443</a></span><span class="line"><span class="comment">%     Calculate ratio of power to prevaporize state relative to initally</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,444" id="srcline444">444</a></span><span class="line"><span class="comment">%     calculated power in order to correct the area of relavent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,445" id="srcline445">445</a></span><span class="line">    <span class="mxinfo " id="T17:U1100"><span class="var type1" id="S97T17U1539">PowerFrac_Vaporize_over_NoVaporize</span> = <span class="mxinfo " id="T17:U1102"><span class="var type1" id="S99T17U1541">P_init_to_postvap</span>./<span class="mxinfo " id="T17:U1104"><span class="var type1" id="S2T1U1543">P</span>(<span class="var type1" id="S98T15U1544">vap_end_ind</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,446" id="srcline446">446</a></span><span class="line">    <span class="mxinfo " id="T17:U1107"><span class="mxinfo " id="T17:U1108"><span class="var type1" id="S74T1U1548">unitA</span>(<span class="var type1" id="S98T15U1549">vap_end_ind</span>)</span> = <span class="mxinfo " id="T17:U1111"><span class="var type1" id="S74T1U1552">unitA</span>(<span class="var type1" id="S98T15U1553">vap_end_ind</span>).*<span class="var type1" id="S97T17U1554">PowerFrac_Vaporize_over_NoVaporize</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,447" id="srcline447">447</a></span><span class="line"><span class="comment">%     Update relevant power values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,448" id="srcline448">448</a></span><span class="line">    <span class="mxinfo " id="T17:U1115"><span class="mxinfo " id="T17:U1116"><span class="var type1" id="S2T1U1558">P</span>(<span class="var type1" id="S98T15U1559">vap_end_ind</span>)</span> = <span class="var type1" id="S99T17U1560">P_init_to_postvap</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,449" id="srcline449">449</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,450" id="srcline450">450</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,451" id="srcline451">451</a></span><span class="line">    <span class="mxinfo " id="T5:U1120"><span class="autoExtrinsicFcn" id="F141N4:B1564">disp</span>(<span class="mxinfo " id="T22:U1121"><span class="string">'~~~~~~~~~~~~~~~~Maintain State~~~~~~~~~~~~~~~~~~~~'</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,452" id="srcline452">452</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,453" id="srcline453">453</a></span><span class="line"><span class="comment">%     Hhi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,454" id="srcline454">454</a></span><span class="line"><span class="comment">%     Hho</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,455" id="srcline455">455</a></span><span class="line"><span class="comment">%     Thi</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,456" id="srcline456">456</a></span><span class="line"><span class="comment">%     Tho</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,457" id="srcline457">457</a></span><span class="line"><span class="comment">%     Hci</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,458" id="srcline458">458</a></span><span class="line"><span class="comment">%     Hco</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,459" id="srcline459">459</a></span><span class="line"><span class="comment">%     Tci</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,460" id="srcline460">460</a></span><span class="line"><span class="comment">%     Tco</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,461" id="srcline461">461</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,462" id="srcline462">462</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,463" id="srcline463">463</a></span><span class="line"><span class="comment">% double check if hot fluid would condense and cool fluid would vaporize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,464" id="srcline464">464</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U1122">any(<span class="mxinfo " id="T15:U1123">(<span class="mxinfo " id="T15:U1124"><span class="mxinfo " id="T15:U1125"><span class="var type1" id="S81T1U1574">Tho</span> &lt; <span class="var type1" id="S50T1U1575">Tvh</span></span> &amp; <span class="mxinfo " id="T15:U1128"><span class="var type1" id="S38T1U1577">Thi</span> &gt; <span class="var type1" id="S50T1U1578">Tvh</span></span></span>) &amp; (<span class="mxinfo " id="T15:U1131"><span class="mxinfo " id="T15:U1132"><span class="var type1" id="S82T1U1582">Tco</span> &gt; <span class="var type1" id="S51T1U1583">Tvc</span></span> &amp; <span class="mxinfo " id="T15:U1135"><span class="var type1" id="S39T1U1585">Tci</span> &lt; <span class="var type1" id="S51T1U1586">Tvc</span></span></span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,465" id="srcline465">465</a></span><span class="line">    error(<span class="string">'This function cannot accurately handle both fluids changing phase.'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,466" id="srcline466">466</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,467" id="srcline467">467</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,468" id="srcline468">468</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T15:U1138"><span class="var type1" id="S14T1U1594">A</span> &gt; <span class="var type1" id="S74T1U1595">unitA</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,469" id="srcline469">469</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,470" id="srcline470">470</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,471" id="srcline471">471</a></span><span class="line"><span class="comment">%     disp(['Power Before: ' num2str(P) ' W'])</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,472" id="srcline472">472</a></span><span class="line">    <span class="message error" id="M1F1C">[ <span class="var type0" id="S100T0U1599"><span class="message error" id="M2F1C">P_next</span></span>, <span class="var type0" id="S85T0U1600"><span class="message error" id="M3F1C">Hho</span></span>, <span class="var type0" id="S86T0U1601"><span class="message error" id="M4F1C">Hco</span></span> ] = <span class="fcn" id="F144N2:B1603">HeatExNTU_3_low</span>( <span class="var type1" id="S85T1U1604">Hho</span>, <span class="var type1" id="S6T1U1605">m_dot_h</span>, <span class="var type1" id="S7T1U1606">p_h</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,473" id="srcline473">473</a></span><span class="line">        <span class="var type1" id="S86T1U1607">Hco</span>, <span class="var type1" id="S9T1U1608">m_dot_c</span>, <span class="var type1" id="S10T1U1609">p_c</span>, <span class="var type1" id="S16T1U1610">fluid_h</span>, <span class="var type1" id="S11T1U1611">fluid_c</span>, <span class="var type1" id="S12T1U1612">HeatExType</span>, <span class="var type1" id="S13T1U1613">U</span>, <span class="mxinfo " id="T1:U1151"><span class="var type1" id="S14T1U1615">A</span> - <span class="var type1" id="S74T1U1616">unitA</span></span>, <span class="mxinfo " id="T12:U1154"><span class="string">'H'</span></span> )</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,474" id="srcline474">474</a></span><span class="line"><span class="comment">%     A</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,475" id="srcline475">475</a></span><span class="line"><span class="comment">%     unitA</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,476" id="srcline476">476</a></span><span class="line"><span class="comment">% %     A - unitA;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,477" id="srcline477">477</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,478" id="srcline478">478</a></span><span class="line">    <span class="var type0" id="S2T0U1620">P</span> = <span class="var type1" id="S2T1U1622">P</span> + <span class="var type0" id="S100T0U1623"><span class="message error" id="M5F1C">P_next</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,479" id="srcline479">479</a></span><span class="line"><span class="comment">%     disp(['Power After: ' num2str(P) ' W'])</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,480" id="srcline480">480</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,481" id="srcline481">481</a></span><span class="line">    <span class="mxinfo " id="T5:U1156"><span class="var type1" id="S87T5U1626">Hho_Ptr</span> = <span class="mxinfo " id="T5:U1158"><span class="extrinsicFcn" id="F235N8:B1628">libpointer</span>(<span class="mxinfo " id="T9:U1159"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S85T1U1630">Hho</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,482" id="srcline482">482</a></span><span class="line">    <span class="mxinfo " id="T5:U1161"><span class="var type1" id="S88T5U1633">Hco_Ptr</span> = <span class="mxinfo " id="T5:U1163"><span class="extrinsicFcn" id="F236N8:B1635">libpointer</span>(<span class="mxinfo " id="T9:U1164"><span class="string">'doublePtr'</span></span>,<span class="var type1" id="S86T1U1637">Hco</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,483" id="srcline483">483</a></span><span class="line"><span class="comment">% Update values located at Tho and Tco pointer locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,484" id="srcline484">484</a></span><span class="line">    <span class="mxinfo " id="T5:U1166"><span class="extrinsicFcn" id="F237N3:B1640">calllib</span>(<span class="mxinfo " id="T6:U1167"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1168"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S26T5U1643">handle_h</span>, <span class="var type1" id="S31T5U1644">hp_ind</span>, <span class="var type1" id="S87T5U1645">Hho_Ptr</span>, <span class="var type1" id="S35T5U1646">p_h_Ptr</span>, <span class="var type1" id="S24T1U1647">var_length</span>, <span class="var type1" id="S32T5U1648">t_ind</span>, <span class="var type1" id="S83T5U1649">Tho_Ptr</span>, <span class="var type1" id="S18T1U1650">ierr</span>,<span class="var type1" id="S20T3U1651">herr</span>,<span class="var type1" id="S17T1U1652">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,485" id="srcline485">485</a></span><span class="line">    <span class="mxinfo " id="T5:U1179"><span class="extrinsicFcn" id="F238N3:B1655">calllib</span>(<span class="mxinfo " id="T6:U1180"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T16:U1181"><span class="string">'AbstractState_update_and_1_out'</span></span>, <span class="var type1" id="S28T5U1658">handle_c</span>, <span class="var type1" id="S31T5U1659">hp_ind</span>, <span class="var type1" id="S88T5U1660">Hco_Ptr</span>, <span class="var type1" id="S37T5U1661">p_c_Ptr</span>, <span class="var type1" id="S24T1U1662">var_length</span>, <span class="var type1" id="S32T5U1663">t_ind</span>, <span class="var type1" id="S84T5U1664">Tco_Ptr</span>, <span class="var type1" id="S18T1U1665">ierr</span>,<span class="var type1" id="S20T3U1666">herr</span>,<span class="var type1" id="S17T1U1667">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,486" id="srcline486">486</a></span><span class="line"><span class="comment">% Set Thi &amp; Tci to values stored at pointer location</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,487" id="srcline487">487</a></span><span class="line">    <span class="mxinfo " id="T1:U1192"><span class="var type1" id="S81T1U1670">Tho</span> = <span class="mxinfo " id="T5:U1194"><span class="extrinsicFcn" id="F239N7:B1672">get</span>(<span class="var type1" id="S83T5U1673">Tho_Ptr</span>,<span class="mxinfo " id="T13:U1196"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,488" id="srcline488">488</a></span><span class="line">    <span class="mxinfo " id="T1:U1197"><span class="var type1" id="S82T1U1677">Tco</span> = <span class="mxinfo " id="T5:U1199"><span class="extrinsicFcn" id="F240N7:B1679">get</span>(<span class="var type1" id="S84T5U1680">Tco_Ptr</span>,<span class="mxinfo " id="T13:U1201"><span class="string">'Value'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,489" id="srcline489">489</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,490" id="srcline490">490</a></span><span class="line"><span class="comment">% else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,491" id="srcline491">491</a></span><span class="line"><span class="comment">%     P</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,492" id="srcline492">492</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,493" id="srcline493">493</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,494" id="srcline494">494</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,495" id="srcline495">495</a></span><span class="line"><span class="comment">% Free the hot and cool fluid handles</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,496" id="srcline496">496</a></span><span class="line"><span class="mxinfo " id="T5:U1202"><span class="extrinsicFcn" id="F241N3:B1684">calllib</span>(<span class="mxinfo " id="T6:U1203"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T23:U1204"><span class="string">'AbstractState_free'</span></span>, <span class="var type1" id="S26T5U1687">handle_h</span>, <span class="var type1" id="S18T1U1688">ierr</span>,<span class="var type1" id="S20T3U1689">herr</span>,<span class="var type1" id="S17T1U1690">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,497" id="srcline497">497</a></span><span class="line"><span class="mxinfo " id="T5:U1209"><span class="extrinsicFcn" id="F242N3:B1693">calllib</span>(<span class="mxinfo " id="T6:U1210"><span class="string">'coolprop'</span></span>,<span class="mxinfo " id="T23:U1211"><span class="string">'AbstractState_free'</span></span>, <span class="var type1" id="S28T5U1696">handle_c</span>, <span class="var type1" id="S18T1U1697">ierr</span>,<span class="var type1" id="S20T3U1698">herr</span>,<span class="var type1" id="S17T1U1699">buffer_size</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,498" id="srcline498">498</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,499" id="srcline499">499</a></span><span class="line"><span class="keyword">if</span> <span class="message error" id="M6F1C">upper(<span class="var type1" id="S15T1U1705">T_or_H</span>)</span> == <span class="string">'T'</span> <span class="comment">%|| 'TEMPERATURE'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,500" id="srcline500">500</a></span><span class="line">    <span class="mxinfo " id="T1:U1217"><span class="var type1" id="S3T1U1709">T_or_H_ho</span> = <span class="var type1" id="S81T1U1710">Tho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,501" id="srcline501">501</a></span><span class="line">    <span class="mxinfo " id="T1:U1220"><span class="var type1" id="S4T1U1713">T_or_H_co</span> = <span class="var type1" id="S82T1U1714">Tco</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,502" id="srcline502">502</a></span><span class="line"><span class="keyword">elseif</span> <span class="message error" id="M7F1C">upper(<span class="var type1" id="S15T1U1719">T_or_H</span>)</span> == <span class="string">'H'</span> <span class="comment">%|| 'ENTHALPY'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,503" id="srcline503">503</a></span><span class="line">    <span class="mxinfo " id="T1:U1224"><span class="var type1" id="S3T1U1723">T_or_H_ho</span> = <span class="var type1" id="S85T1U1724">Hho</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,504" id="srcline504">504</a></span><span class="line">    <span class="mxinfo " id="T1:U1227"><span class="var type1" id="S4T1U1727">T_or_H_co</span> = <span class="var type1" id="S86T1U1728">Hco</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,505" id="srcline505">505</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,506" id="srcline506">506</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,507" id="srcline507">507</a></span><span class="line"></span></span>
</pre>
</body>
</html>
